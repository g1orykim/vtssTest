/*

 Vitesse API software.

 Copyright (c) 2002-2014 Vitesse Semiconductor Corporation "Vitesse". All
 Rights Reserved.

 Unpublished rights reserved under the copyright laws of the United States of
 America, other countries and international treaties. Permission to use, copy,
 store and modify, the software and its source code is granted. Permission to
 integrate into other products, disclose, transmit and distribute the software
 in an absolute machine readable format (e.g. HEX file) is also granted.  The
 source code of the software may not be disclosed, transmitted or distributed
 without the written permission of Vitesse. The software and its source code
 may only be used in products utilizing the Vitesse switch products.

 This copyright notice must appear in any copy, modification, disclosure,
 transmission or distribution of the software. Vitesse retains all ownership,
 copyright, trade secret and proprietary rights in the software.

 THIS SOFTWARE HAS BEEN PROVIDED "AS IS," WITHOUT EXPRESS OR IMPLIED WARRANTY
 INCLUDING, WITHOUT LIMITATION, IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS
 FOR A PARTICULAR USE AND NON-INFRINGEMENT.

 $Id$
 $Revision$

*/

#define VTSS_TRACE_GROUP VTSS_TRACE_GROUP_PHY
#define VTSS_TRACE_LAYER VTSS_TRACE_LAYER_CIL


// Avoid "vtss_api.h not used in module vtss_phy_10g.c"
/*lint --e{766} */
/*lint -sem(phy_10g_mode_conf_set,              thread_protected) */
/*lint -sem(phy_10g_loopback_set,               thread_protected) */
/*lint -sem(phy_10g_rxckout_set,                thread_protected) */
/*lint -sem(phy_10g_txckout_set,                thread_protected) */
/*lint -sem(phy_10g_srefclk_set,                thread_protected) */
/*lint -sem(phy_10g_power_set,                  thread_protected) */
/*lint -sem(phy_10g_base_kr_conf_set,           thread_protected) */
/*lint -sem(phy_10g_clause_37_status_get,       thread_protected) */
/*lint -sem(phy_10g_clause_37_control_set,      thread_protected) */

#include "vtss_api.h"
#if defined(VTSS_CHIP_10G_PHY)
#include "../../ail/vtss_state.h"
#include "../../ail/vtss_common.h"
#include "vtss_phy_10g.h"
/*
 * Define register bit fields used in the API but defined as [DBG] in the register description,
 * I.e. they are not defined in the autogenerated header files (this should be changed, when we have an overview over the needs
 */
#define  VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_SPARE_POOL(x)  VTSS_ENCODE_BITFIELD(x,22,8)
#define  VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_SPARE_POOL     VTSS_ENCODE_BITMASK(22,8)
#define  VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_PWD_RX  VTSS_BIT(1)
#define  VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_PWD_TX  VTSS_BIT(0)
#define  VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_ENA_PLOOP  VTSS_BIT(8)

#define  VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_DFE_ENA VTSS_BIT(14)
#define  VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_IE_SDET_ENA VTSS_BIT(8)
#define  VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_SKIP_CAL VTSS_BIT(9)

/* Define registers that has changed address in Venice Rev B */
#define VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_REV_B  VTSS_IOREG(0x1e, 1, 0xf049) /* 0xf048 in RevA -> 0xf049 in RevB*/

/* Debug registers from APC block, i.e. not available through normal header files */
#define VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT_HI(x) VTSS_ENCODE_BITFIELD(x,22,4)
#define VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT_HI VTSS_ENCODE_BITMASK(22,4)
#define VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_SPARE_POOL(x) VTSS_ENCODE_BITFIELD(x,22,8)
#define VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_SPARE_POOL VTSS_ENCODE_BITMASK(22,8)
#define VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_SYN_CLK_ENA VTSS_BIT(15)
#define VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_LOOP_CTRL_ENA VTSS_BIT(11)
#define VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_LOOP_ENA VTSS_BIT(10)
#define VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_OOR_RECAL_ENA VTSS_BIT(6)
#define VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_IS_CAL_CFG1_START_OFFSCAL_REV_B VTSS_BIT(0)
#define VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_LD_CAL_CFG_START_DETLVL_CAL_REV_B VTSS_BIT(0)

/* Rev B APC registers (the addresses have changed from Rev A)  */
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_REV_B                  VTSS_IOREG(0x01, 1, 0xf001)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_PARCTRL_SYNC_CFG_REV_B             VTSS_IOREG(0x01, 1, 0xf002)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_PARCTRL_FSM1_TIMER_CFG_REV_B       VTSS_IOREG(0x01, 1, 0xf003)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_PARCTRL_FSM2_TIMER_CFG_REV_B       VTSS_IOREG(0x01, 1, 0xf004)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_FLEXCTRL_CNT_STATUS_REV_B          VTSS_IOREG(0x01, 1, 0xf005)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_LD_CAL_CFG_REV_B                   VTSS_IOREG(0x01, 1, 0xf006)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_IS_CAL_CFG0_REV_B                  VTSS_IOREG(0x01, 1, 0xf007)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_IS_CAL_CFG1_REV_B                  VTSS_IOREG(0x01, 1, 0xf008)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_COMMON_CFG_REV_B               VTSS_IOREG(0x01, 1, 0xf009)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_GAIN_CTRL_CFG_REV_B            VTSS_IOREG(0x01, 1, 0xf00A)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_GAIN_ADJ_CTRL_CFG_REV_B        VTSS_IOREG(0x01, 1, 0xf00B)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_CTRL_STATUS_REV_B              VTSS_IOREG(0x01, 1, 0xf00C)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_REV_B                  VTSS_IOREG(0x01, 1, 0xf00D)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG0_REV_B             VTSS_IOREG(0x01, 1, 0xf00E)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG1_REV_B             VTSS_IOREG(0x01, 1, 0xf00F)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0_REV_B           VTSS_IOREG(0x01, 1, 0xf010)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1_REV_B           VTSS_IOREG(0x01, 1, 0xf011)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_CTRL_REV_B                VTSS_IOREG(0x01, 1, 0xf012)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_TIMER_CFG_REV_B           VTSS_IOREG(0x01, 1, 0xf013)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_PAR_CFG_REV_B             VTSS_IOREG(0x01, 1, 0xf014)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_CTRL_REV_B                   VTSS_IOREG(0x01, 1, 0xf015)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_TIMER_CFG_REV_B              VTSS_IOREG(0x01, 1, 0xf016)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_PAR_CFG_REV_B                VTSS_IOREG(0x01, 1, 0xf017)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_CTRL_REV_B                   VTSS_IOREG(0x01, 1, 0xf018)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_TIMER_CFG_REV_B              VTSS_IOREG(0x01, 1, 0xf019)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_PAR_CFG_REV_B                VTSS_IOREG(0x01, 1, 0xf01A)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_CTRL_REV_B                 VTSS_IOREG(0x01, 1, 0xf01B)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_TIMER_CFG_REV_B            VTSS_IOREG(0x01, 1, 0xf01C)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG_REV_B              VTSS_IOREG(0x01, 1, 0xf01D)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_CTRL_REV_B                    VTSS_IOREG(0x01, 1, 0xf01E)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_TIMER_CFG_REV_B               VTSS_IOREG(0x01, 1, 0xf01F)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_PAR_CFG_REV_B                 VTSS_IOREG(0x01, 1, 0xf020)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_CTRL_REV_B                    VTSS_IOREG(0x01, 1, 0xf021)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_TIMER_CFG_REV_B               VTSS_IOREG(0x01, 1, 0xf022)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_PAR_CFG_REV_B                 VTSS_IOREG(0x01, 1, 0xf023)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_CTRL_REV_B                    VTSS_IOREG(0x01, 1, 0xf024)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_TIMER_CFG_REV_B               VTSS_IOREG(0x01, 1, 0xf025)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_PAR_CFG_REV_B                 VTSS_IOREG(0x01, 1, 0xf026)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_CTRL_REV_B                    VTSS_IOREG(0x01, 1, 0xf027)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_TIMER_CFG_REV_B               VTSS_IOREG(0x01, 1, 0xf028)
#define VTSS_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_PAR_CFG_REV_B                 VTSS_IOREG(0x01, 1, 0xf029)


#if defined(VTSS_IOREG)
#undef VTSS_IOREG
#endif
#if defined(VTSS_IOREG_IX)
#undef VTSS_IOREG_IX
#endif
#include "../phy_10g/chips/venice/vtss_venice_regs.h"
#define VTSS_IOREG(dev, is32, off)  _ioreg(&io_prm, (dev), (is32), (off))
#define VTSS_PHY_ASSERT(x,_txt) if((x)) { VTSS_E("%s",_txt); return VTSS_RC_ERROR;}
#define PHY_BASE_PORT(p) (base_port(vtss_state, p))
#define VEN_REV(_rev_a,front) (_rev_a ? VTSS_##front : VTSS_##front##_REV_B)
#define PST(front,line,back) (line ? front##_LINE_##back : front##_HOST_##back)

static ioreg_blk *_ioreg(ioreg_blk *io, u16 dev, BOOL is32, u32 addr)
{
    io->mmd = dev;
    io->is32 = is32;
    io->addr = addr;
    return io;
}
static ioreg_blk io_prm;
/* ================================================================= *
 *  Register access
 * ================================================================= */
static vtss_rc get_base_adr(u32 dev, u32 addr, u16 *base)
{
    if (dev==1) {
        if (addr >= 0xF000) {*base =  0xF000;}
    } else if (dev == 3) {
        if ((addr >= 0xF000) && (addr < 0xF07F)) { *base = 0xF000;}
        else if((addr >= 0xF100) && (addr < 0xF17F)) { *base = 0xF100;}
        else if((addr >= 0xF200) && (addr < 0xF27F)) { *base = 0xF200;}
    } else if (dev == 30) {
        if ((addr >= 0x9000) && (addr < 0x91FF)) { *base = 0x9000;}
        else if ((addr >= 0x9200) && (addr < 0x93FF)) { *base = 0x9200;}
        else if ((addr >= 0xA000) && (addr < 0xA7FF)) { *base = 0xA000;}
        else if ((addr >= 0xA800) && (addr < 0xAFFF)) { *base = 0xA800;}
        else if ((addr >= 0xB000) && (addr < 0xB7FF)) { *base = 0xB000;}
        else if ((addr >= 0xB800) && (addr < 0xBFFF)) { *base = 0xB800;}
        else if ((addr >= 0xC000) && (addr < 0xC7FF)) { *base = 0xC000;}
        else if ((addr >= 0xC800) && (addr < 0xCFFF)) { *base = 0xC800;}
        else if ((addr >= 0xF000) && (addr < 0xF07F)) { *base = 0xF000;}
        else VTSS_E("dev %x, bad adress %x", dev, addr);
    } else if (dev == 31) {
        if (addr <= 0x8000) { *base = 0;}
        else { *base = 0x8000;}
    } else {
        return VTSS_RC_ERROR;
    }

    return VTSS_RC_OK;
}

static BOOL get_is32(u32 dev, u32 addr)
{
    if ((dev == 0x1E) && (addr >= 0x9000))     { return 1;}
    else if ((dev == 0x1) && (addr >= 0xF000)) { return 1;}
    else if ((dev == 0x3) && (addr >= 0xF000)) { return 1;}
    else if (dev == 0x1F) { return 1;}
    else { return 0;}
}


#define CSR_RD(p, io_reg, value)     \
    {   \
       vtss_rc __rc = _csr_rd(vtss_state, p, io_reg, value); \
        if (__rc != VTSS_RC_OK)           \
            return __rc;                  \
    }


#define CSR_WR(p, io_reg, value)                 \
    {\
      vtss_rc __rc = _csr_wr(vtss_state, p, io_reg, value); \
        if (__rc != VTSS_RC_OK)           \
            return __rc;                  \
    }

#define CSR_WRM(p, io_reg, value, mask) \
    { \
        vtss_rc __rc = _csr_wrm(vtss_state, p, io_reg, value, mask); \
        if (__rc != VTSS_RC_OK)                  \
            return __rc;                         \
    }

/* forward declarations */
static vtss_rc phy_10g_f2df_set(struct vtss_state_s *vtss_state,
                                vtss_port_no_t port_no);
static vtss_rc phy_10g_srefclk_set_internal(struct vtss_state_s *vtss_state,
        vtss_port_no_t port_no,
        vtss_phy_10g_srefclk_mode_t *srefclk);
static vtss_rc phy_10g_srefclk_set(struct vtss_state_s *vtss_state,
                                   vtss_port_no_t port_no);
static vtss_rc phy_10g_rxckout_set(struct vtss_state_s *vtss_state,
                                        vtss_port_no_t port_no);
static vtss_rc phy_10g_txckout_set(struct vtss_state_s *vtss_state,
                                      vtss_port_no_t port_no);


static vtss_port_no_t pma_port_no(vtss_state_t *vtss_state, vtss_port_no_t port_no) 
{
    /* Only one PMA in VSC8491 at channel 0  */
    if (vtss_state->phy_10g_state[port_no].type == VTSS_PHY_TYPE_8491) {
        return vtss_state->phy_10g_state[port_no].phy_api_base_no;
    }
    return port_no;
}


static BOOL venice_rev_a(vtss_state_t *vtss_state, vtss_port_no_t port_no) 
{
    if (vtss_state->phy_10g_state[port_no].revision == 0) {
        return 1;
    } else {
        return 0;
    }
}

#define RX_TX_MAX_MODES 3
/*                                                            1.25G,   10G LAN,       WAN */
static const u32 rx_tx_synth_freq_mult_norm   [RX_TX_MAX_MODES] = {0x2000,    0x2100,    0x1fd9};
static const u32 rx_tx_synth_freq_mult_l3     [RX_TX_MAX_MODES] = {0x2002,    0x2102,    0x1fdb};
static const u32 rx_tx_synth_freqm_0_norm     [RX_TX_MAX_MODES] = {     0,         0,0xD0D8CB08};
static const u32 rx_tx_synth_freqm_0_l3       [RX_TX_MAX_MODES] = {     0,0x80000000,0xD0D8CB08};


static u32 phy_10g_rx_tx_reg_mode_idx(struct vtss_state_s *vtss_state,
                                vtss_port_no_t port_no)
{
    u32 reg_idx;
    switch (vtss_state->phy_10g_state[port_no].mode.oper_mode) {
        case VTSS_PHY_LAN_MODE:
        case VTSS_PHY_LAN_SYNCE_MODE:
        case VTSS_PHY_LAN_MIXED_SYNCE_MODE:
            reg_idx = 1;
            break;
        case VTSS_PHY_WAN_MODE:
        case VTSS_PHY_WAN_SYNCE_MODE:
        case VTSS_PHY_WAN_MIXED_SYNCE_MODE:
            reg_idx = 2;
            break;
        case VTSS_PHY_1G_MODE:
            reg_idx = 0;
            break;
        default:
            VTSS_E("Serdes10g mode not supported");
            reg_idx = 1;
    }
    return reg_idx;
}


#ifdef VTSS_FEATURE_10GBASE_KR
static vtss_rc phy_10g_kr_conf_init(vtss_state_t *vtss_state,
                            const vtss_port_no_t port_no);
#endif /* VTSS_FEATURE_10GBASE_KR */

static vtss_rc csr_rd(vtss_state_t *vtss_state, vtss_port_no_t port_no, u16 mmd, BOOL is32, u32 addr, u32 *value)
{
    u32                        reg_addr = 0,  addr_tmp = addr;;
    u16                        reg_value[2];
    u16                        base_addr;
    vtss_mmd_read_t            mmd_read_func = vtss_state->init_conf.mmd_read;
    vtss_mmd_read_inc_t        mmd_read_inc_func = vtss_state->init_conf.mmd_read_inc;


    if (is32) {
        VTSS_RC(get_base_adr(mmd, addr, &base_addr));
        addr = addr-base_addr;
        reg_addr = base_addr | (addr << 1);
        VTSS_RC(mmd_read_inc_func(vtss_state, port_no, mmd, reg_addr, reg_value, 2));
        *value = reg_value[0] + (((u32)reg_value[1])<<16);
        VTSS_N("Read 32, iport %d: %02x_%04x -> %08x (addr=%x)", port_no, mmd, reg_addr, *value, addr_tmp);

    } else {
        *value = 0;
        VTSS_RC(mmd_read_func(vtss_state, port_no, mmd, addr, &reg_value[0]));
        *value = (u32)reg_value[0];
        VTSS_N("Read 16, iport %d: %02x_%04x -> %08x", port_no, mmd, addr, *value);
    }

    return VTSS_RC_OK;
}


static vtss_rc csr_wr(vtss_state_t *vtss_state, vtss_port_no_t port_no, u16 mmd, BOOL is32, u32 addr, u32 value)
{
    u16               reg_value_upper, reg_value_lower, reg_addr;
    u16               base_addr;
    u32               addr_tmp = addr;


    /* Divide the 32 bit value to [15..0] Bits & [31..16] Bits */
    reg_value_lower = (value & 0xffff);
    reg_value_upper = (value >> 16);

    vtss_mmd_write_t  mmd_write_func = vtss_state->init_conf.mmd_write;

    if (is32) {
        VTSS_RC(get_base_adr(mmd, addr, &base_addr));
        addr = addr-base_addr;
        reg_addr = base_addr | (addr << 1);
        VTSS_N("Write 32, iport %d: %02x_%04x <- %08x (addr=%x)", port_no, mmd, reg_addr, value, addr_tmp);
        /* Write the Upper 2 Bytes */
        VTSS_RC(mmd_write_func(vtss_state, port_no, mmd, (reg_addr|1), reg_value_upper));
        /* Write the Lower 2 Bytes */
        VTSS_RC(mmd_write_func(vtss_state, port_no, mmd, reg_addr, reg_value_lower));
    } else {
        VTSS_N("Write 16, iport %d: %02x_%04x <- %04x", port_no, mmd, addr, reg_value_lower);
        VTSS_RC(mmd_write_func(vtss_state, port_no, mmd, addr, reg_value_lower));
    }
    return VTSS_RC_OK;
}

static vtss_rc csr_wrm(vtss_state_t *vtss_state, vtss_port_no_t port_no, u16 mmd, BOOL is32, u32 addr, u32 value, u32 mask)
{
    vtss_rc rc;
    u32     val;

    if ((rc = csr_rd(vtss_state, port_no, mmd, is32, addr, &val)) == VTSS_RC_OK) {
        val = ((val & ~mask) | (value & mask));
        rc = csr_wr(vtss_state, port_no, mmd, is32, addr, val);
    }
    return rc;
}

static vtss_rc _csr_rd(vtss_state_t *vtss_state, vtss_port_no_t port_no, ioreg_blk *io, u32 *value)
{
    return csr_rd(vtss_state, port_no, io->mmd, io->is32, io->addr, value);
}

static vtss_rc _csr_wr(vtss_state_t *vtss_state, vtss_port_no_t port_no, ioreg_blk *io, u32 value)
{
    return csr_wr(vtss_state, port_no, io->mmd, io->is32, io->addr, value);
}

static vtss_rc _csr_wrm(vtss_state_t *vtss_state, vtss_port_no_t port_no, ioreg_blk *io, u32 value, u32 mask)
{
    return csr_wrm(vtss_state, port_no, io->mmd, io->is32, io->addr, value, mask);
}


/* ================================================================= *
 *  Static Functions
 * ================================================================= */

static vtss_rc phy_10g_csr_read(vtss_state_t                *vtss_state,
                                const vtss_port_no_t        port_no,
                                const u32                   dev,
                                const u32                   addr,
                                u32                         *const value)
{
    vtss_rc rc = VTSS_RC_ERROR;
    if ((rc = csr_rd(vtss_state, port_no, dev, get_is32(dev, addr), addr, value)) != VTSS_RC_OK) {
        VTSS_E("Could not do CSR read");
    }
    return rc;
}

static vtss_rc phy_10g_csr_write(vtss_state_t                *vtss_state,
                                 const vtss_port_no_t        port_no,
                                 const u32                   dev,
                                 const u32                   addr,
                                 const u32                   value)
{
    vtss_rc rc = VTSS_RC_ERROR;
    if ((rc = csr_wr(vtss_state, port_no, dev, get_is32(dev, addr), addr, value)) != VTSS_RC_OK) {
        VTSS_E("Could not do CSR write");
    }

    return rc;
}

/* static vtss_rc vtss_phy_10g_loopback_set_private(vtss_state_t *vtss_state, */
/*                                                  const vtss_port_no_t port_no) */

/* { */

   // L4 loopback but No Link:

    /* CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10_IB_LOOP_DRV, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10_IB_LOOP_DRV); */

    /* CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_INP_LOOP, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_INP_LOOP); */



   // L3 loopback but No Link:
    /* CSR_WRM(port_no, VTSS_VENICE_DEV1_LOOPBACK_CONTROL_PMA_LOOPBACK_CONTROL, */
    /*         VTSS_F_VENICE_DEV1_LOOPBACK_CONTROL_PMA_LOOPBACK_CONTROL_L3_CONTROL, */
    /*         VTSS_F_VENICE_DEV1_LOOPBACK_CONTROL_PMA_LOOPBACK_CONTROL_L3_CONTROL); */


    /* CSR_RD(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CDRLF, &value); */
    /* CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL(VTSS_X_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL(value)),  */
    /*         VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL); */

    /* CSR_WRM(port_no,VTSS_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG, */
    /*         VTSS_F_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC(vtss_state->phy_10g_state[port_no].channel_id), */
    /*         VTSS_M_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC); */

    /* CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT(1<<1) | */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT(1<<1), */
    /*         VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT | */
    /*         VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT); */

    /* CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E(0), */
    /*         VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E); */


    /* CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA); */


    /* CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1, */
    /*         VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E(3), */
    /*         VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E); */
/* } */

/* The code in this function is autogenerated from an TCL script */
static vtss_rc venice_apc_setup_rx(vtss_state_t *vtss_state, vtss_port_no_t port_no)
{

    if (venice_rev_a(vtss_state, port_no)) {
        // Rev A
        VTSS_I("Rev A - venice_apc_setup_rx port:%u",port_no);
        // #setup sd10g65_rx into 0.88GHz/40b mode
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_SPEED_SEL(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_SPEED_SEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_AUX_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_AUX_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_SAM_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_SAM_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_CLKDIV_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_CLKDIV_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_CML_CURR);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_SPEED_SEL, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_SPEED_SEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_FBDIV_SEL);    
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT_HI(4),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT_HI);   
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT(5767),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQM_1(1), 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQM_1);
        CSR_WR(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG3, 1477468750);        
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQN_1(8),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQN_1);
        CSR_WR(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG4, 0);    
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_FB_STEP(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_FB_STEP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I2_STEP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1E);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I2_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I2_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_CONV_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_CONV_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA(64),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_AUX(42),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_AUX);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_P_STEP, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_P_STEP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I1_STEP, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I1_STEP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1E(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1E);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1M(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1M);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_FSEL(2), 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_FSEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_LIM(2), 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_LIM);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_MAX1(2), 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_MAX1);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_SPARE_POOL(7),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_SPARE_POOL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA(15),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL(47),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_EQZ_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_EQZ_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_DFE_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_DFE_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_LD_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_LD_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SDET_SEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_IA_SDET_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_IA_SDET_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE(31),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_LAT_NEUTRAL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_MAIN_THRES(32),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_MAIN_THRES);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_RCML_ADJ);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_RIB_ADJ);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_CALMUX_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_CALMUX_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES(40),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES(23),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_IB);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES2);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES1);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                0, 
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES0);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN(300),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG6,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG6_IB_EQZ_GAIN_ADJ(70),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG6_IB_EQZ_GAIN_ADJ);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10_IB_LOOP_DRV);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10_IB_LOOP_REC);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_A(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_A);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_B(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_B);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_CPMD_SWAP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_DIS);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0_DES_IF_MODE_SEL(5), 
                VTSS_M_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0_DES_IF_MODE_SEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_CUR(1), 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_CUR);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_RES(10),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_RES);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_START_CNT(2), 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_START_CNT);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_SYN_CLK_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_LOOP_CTRL_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_LOOP_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG1_PLLF_REF_CNT_END(2909), 
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG1_PLLF_REF_CNT_END);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_OOR_RECAL_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_OOR_RECAL_ENA);
        VTSS_MSLEEP(10);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        VTSS_MSLEEP(10);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_OOR_RECAL_ENA);

        VTSS_I("Done- venice_apc_setup_rx port:%u",port_no);
    } else {
        // Rev B, setup sd10g65_rx into 10.3125GHz/32b mode
        VTSS_I("Rev B - venice_apc_setup_rx port:%u",port_no);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_SPEED_SEL(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_SPEED_SEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_AUX_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_AUX_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_SAM_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_SAM_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_CLKDIV_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_CLKDIV_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_CML_CURR);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_SPEED_SEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_FBDIV_SEL(2),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_FBDIV_SEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT_HI(4),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT_HI);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT(8448),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQM_1);
        CSR_WR(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG3, 0);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQN_1(8),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQN_1);
        CSR_WR(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG4, 0);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_FB_STEP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I2_STEP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1E);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I2_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I2_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_CONV_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_CONV_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA(54),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_AUX(42),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_AUX);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_P_STEP,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_P_STEP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I1_STEP,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_I1_STEP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1E(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1E);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1M(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1M);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_FSEL(2),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_FSEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_LIM(2),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_LIM);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_MAX1(2),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_MAX1);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_SPARE_POOL(7),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_SPARE_POOL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA(15),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL(47),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_EQZ_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_EQZ_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_DFE_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_DFE_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_LD_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_LD_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SDET_SEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_IA_SDET_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_IA_SDET_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE(31),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_LAT_NEUTRAL, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_LAT_NEUTRAL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8,
                0, 
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_LAT_NEUTRAL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_MAIN_THRES(32),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_MAIN_THRES);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_RCML_ADJ);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_RIB_ADJ);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_CALMUX_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_CALMUX_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES(40),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES(23),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_IB);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES2);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES1);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                0,
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES0);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN(300),
                VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10_IB_LOOP_DRV);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10_IB_LOOP_REC);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_A(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_A);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_B(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_B);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_CPMD_SWAP);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_DIS);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0_DES_IF_MODE_SEL(4),
                VTSS_M_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0_DES_IF_MODE_SEL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_CUR(3),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_CUR);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_RES(10),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_RES);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_START_CNT(2),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_START_CNT);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_SYN_CLK_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_LOOP_CTRL_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_LOOP_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG1_PLLF_REF_CNT_END(198),
                VTSS_M_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG1_PLLF_REF_CNT_END);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_OOR_RECAL_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_OOR_RECAL_ENA);
        VTSS_MSLEEP(10);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        VTSS_MSLEEP(10);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_OOR_RECAL_ENA);
    }    
    return VTSS_RC_OK;
}

static vtss_rc venice_apc_calibrate_ib(vtss_state_t *vtss_state, vtss_port_no_t port_no)
{
    BOOL rev_a = venice_rev_a(vtss_state, port_no);

    VTSS_I("Rev:%s - venice_apc_calibrate_ib: port %u",rev_a?"A":"B", port_no);
    /*  Configure IB */
    CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
            0, /* Switch off */
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_DFE_ENA);

    /* Settings for offset cal. */
    CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG7,
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG7_IB_DFE_OFFSET_L(6) |
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG7_IB_MAIN_THRES_CAL(48),
            VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG7_IB_DFE_OFFSET_L |
            VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG7_IB_MAIN_THRES_CAL);

    /* Settings for threshold cal. */
    CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG7,
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG7_IB_DFE_OFFSET_H(25),
            VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG7_IB_DFE_OFFSET_H);

    CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES(40) |
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES(23),
            VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES |
            VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES);

    /* Settings for LD/SD cal */
    CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_LD_ENA |
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_IE_SDET_ENA,
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_LD_ENA |
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_IE_SDET_ENA);
    CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3,
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SDET_SEL,
            VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SDET_SEL);


    /* Correct inappropriate reset value in APC gain ctrl */
    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_COMMON_CFG),
            0, /* Disable auto restart capability */
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_COMMON_CFG_EQZ_GAIN_AUTO_RESTART);

    /* Settings for DFE calibariation */
    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG_EQZ_AGC_INI(53),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG_EQZ_AGC_INI);

    /* Configure APC */
    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_RESET_APC, /* Reset */
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_RESET_APC);
    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0),
            0,                                                           /* Release reset */
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_RESET_APC);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_DIRECT_ENA |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_MODE(1),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_DIRECT_ENA |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_MODE);


    if (rev_a) {
        /* Calibration for Rev A */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_OFFSCAL_DIS_SWAP,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_OFFSCAL_DIS_SWAP);


        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_DETLVL_TIMER(15),
                VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_DETLVL_TIMER);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_OFFSCAL_IB_SEL);


        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_START_OFFSCAL, /* Start cal. */
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_START_OFFSCAL);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_START_OFFSCAL);

        VTSS_MSLEEP(10);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1, /* Start cal */
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_START_DETLVL_CAL,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_START_DETLVL_CAL);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_START_DETLVL_CAL);

        VTSS_MSLEEP(10);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1, /* Start IE */
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_OFFSCAL_IB_SEL,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_OFFSCAL_IB_SEL);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_START_OFFSCAL, /* Start cal. */
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_START_OFFSCAL);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG1_START_OFFSCAL);

        VTSS_MSLEEP(15);
    } else {

        /* Calibration for Rev B */

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_IS_CAL_CFG1_REV_B,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_IS_CAL_CFG1_START_OFFSCAL_REV_B, /* start IS cal */
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_IS_CAL_CFG1_START_OFFSCAL_REV_B);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_IS_CAL_CFG1_REV_B,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_IS_CAL_CFG1_START_OFFSCAL_REV_B);

        VTSS_MSLEEP(200);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_LD_CAL_CFG_REV_B,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_LD_CAL_CFG_START_DETLVL_CAL_REV_B, /* startcal */
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_LD_CAL_CFG_START_DETLVL_CAL_REV_B);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_APC_APC_LD_CAL_CFG_REV_B,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_LD_CAL_CFG_START_DETLVL_CAL_REV_B);

        VTSS_MSLEEP(10);

    }

    /* Disable APC mode */
    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0),
            0,
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_DIRECT_ENA |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_MODE);

    VTSS_I("Done - venice_apc_calibrate_ib: port %u", port_no);
    return VTSS_RC_OK;
}

static vtss_rc venice_apc_cfg(vtss_state_t *vtss_state, vtss_port_no_t port_no)
{     
    u32 if_width;
    vtss_phy_10g_mode_t *mode = &vtss_state->phy_10g_state[port_no].mode;
    BOOL rev_a = venice_rev_a(vtss_state, port_no);

    switch (mode->oper_mode) {
        case VTSS_PHY_LAN_MODE:
        case VTSS_PHY_LAN_SYNCE_MODE:
        case VTSS_PHY_WAN_MODE:
        case VTSS_PHY_WAN_SYNCE_MODE:
        case VTSS_PHY_LAN_MIXED_SYNCE_MODE:
        case VTSS_PHY_WAN_MIXED_SYNCE_MODE:
            if_width = 4;
            break;
        case VTSS_PHY_1G_MODE:
            if_width = 1;
            break;
    default:
        VTSS_E("Serdes10g mode not supported");
        return VTSS_RC_ERROR;
    }

    VTSS_I("Rev:%s - Configure the APC: port %u",rev_a?"A":"B", port_no);
    /* Configure the APC */
    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_SKIP_CAL |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_IF_WIDTH(if_width) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_DIRECT_ENA,
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_SKIP_CAL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_IF_WIDTH |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_DIRECT_ENA);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_PARCTRL_SYNC_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_PARCTRL_SYNC_CFG_FSM2_OP_MODE(2),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_PARCTRL_SYNC_CFG_FSM2_OP_MODE);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_COMMON_CFG),
            0, /* Disable auto restart capability */
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_COMMON_CFG_EQZ_GAIN_AUTO_RESTART)

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_LD_LEV_INI(24),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_LD_LEV_INI);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG0),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG0_LD_T_DEADTIME_WRK(65535) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG0_LD_T_TIMEOUT_WRK(1000),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG0_LD_T_DEADTIME_WRK |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG0_LD_T_TIMEOUT_WRK);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG1),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG1_LD_T_DEADTIME_CAL(65535) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG1_LD_T_TIMEOUT_CAL(1000),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG1_LD_T_DEADTIME_CAL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_LD_CTRL_CFG1_LD_T_TIMEOUT_CAL);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0_EQZ_C_PAT_MASK(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0_EQZ_C_PAT_MATCH(5) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0_EQZ_L_PAT_MASK(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0_EQZ_L_PAT_MATCH(5),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0_EQZ_C_PAT_MASK |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0_EQZ_C_PAT_MATCH |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0_EQZ_L_PAT_MASK |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG0_EQZ_L_PAT_MATCH);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1_EQZ_OFFS_PAT_MASK(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1_EQZ_OFFS_PAT_MATCH(5) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1_EQZ_AGC_PAT_MASK(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1_EQZ_AGC_PAT_MATCH(5),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1_EQZ_OFFS_PAT_MASK |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1_EQZ_OFFS_PAT_MATCH |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1_EQZ_AGC_PAT_MASK |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_PAT_MATCH_CFG1_EQZ_AGC_PAT_MATCH);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_CTRL),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_CTRL_EQZ_OFFS_SYNC_MODE(1),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_CTRL_EQZ_OFFS_SYNC_MODE);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_PAR_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_PAR_CFG_EQZ_OFFS_RANGE_SEL(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_PAR_CFG_EQZ_OFFS_MAX(255) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_PAR_CFG_EQZ_OFFS_INI(128),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_PAR_CFG_EQZ_OFFS_RANGE_SEL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_PAR_CFG_EQZ_OFFS_MAX |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_OFFS_PAR_CFG_EQZ_OFFS_INI);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_CTRL),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_CTRL_EQZ_C_SYNC_MODE(1),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_CTRL_EQZ_C_SYNC_MODE);


    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_PAR_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_PAR_CFG_EQZ_C_RANGE_SEL(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_PAR_CFG_EQZ_C_MAX(31) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_PAR_CFG_EQZ_C_MAX(10),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_PAR_CFG_EQZ_C_RANGE_SEL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_PAR_CFG_EQZ_C_MAX |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_C_PAR_CFG_EQZ_C_MAX);


    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_CTRL),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_CTRL_EQZ_L_SYNC_MODE(1),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_CTRL_EQZ_L_SYNC_MODE);


    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_PAR_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_PAR_CFG_EQZ_L_RANGE_SEL(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_PAR_CFG_EQZ_L_MAX(63) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_PAR_CFG_EQZ_L_INI(20),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_PAR_CFG_EQZ_L_RANGE_SEL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_PAR_CFG_EQZ_L_MAX |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_L_PAR_CFG_EQZ_L_INI);
            
    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_CTRL),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_CTRL_EQZ_AGC_SYNC_MODE(1),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_CTRL_EQZ_AGC_SYNC_MODE);


    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG_EQZ_AGC_RANGE_SEL(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG_EQZ_AGC_MAX(255) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG_EQZ_AGC_INI(128),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG_EQZ_AGC_RANGE_SEL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG_EQZ_AGC_MAX |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_EQZ_AGC_PAR_CFG_EQZ_AGC_INI);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_DFE1_CTRL),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_CTRL_DFE1_SYNC_MODE(1),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_CTRL_DFE1_SYNC_MODE);


    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_DFE1_PAR_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_PAR_CFG_DFE1_RANGE_SEL(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_PAR_CFG_DFE1_MAX(127) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_PAR_CFG_DFE1_INI(64),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_PAR_CFG_DFE1_RANGE_SEL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_PAR_CFG_DFE1_MAX |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE1_PAR_CFG_DFE1_INI);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_DFE2_CTRL),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_CTRL_DFE2_SYNC_MODE(1),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_CTRL_DFE2_SYNC_MODE);


    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_DFE2_PAR_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_PAR_CFG_DFE2_RANGE_SEL(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_PAR_CFG_DFE2_MAX(63) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_PAR_CFG_DFE2_INI(32),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_PAR_CFG_DFE2_RANGE_SEL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_PAR_CFG_DFE2_MAX |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE2_PAR_CFG_DFE2_INI);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_DFE3_CTRL),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_CTRL_DFE3_SYNC_MODE(1),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_CTRL_DFE3_SYNC_MODE);


    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_DFE3_PAR_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_PAR_CFG_DFE3_RANGE_SEL(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_PAR_CFG_DFE3_MAX(31) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_PAR_CFG_DFE3_INI(16),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_PAR_CFG_DFE3_RANGE_SEL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_PAR_CFG_DFE3_MAX |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE3_PAR_CFG_DFE3_INI);


    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_DFE4_CTRL),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_CTRL_DFE4_SYNC_MODE(1),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_CTRL_DFE4_SYNC_MODE);

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_DFE4_PAR_CFG),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_PAR_CFG_DFE4_RANGE_SEL(15) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_PAR_CFG_DFE4_MAX(31) |
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_PAR_CFG_DFE4_INI(16),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_PAR_CFG_DFE4_RANGE_SEL |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_PAR_CFG_DFE4_MAX |
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_DFE4_PAR_CFG_DFE4_INI);

    VTSS_MSLEEP(1); /* Must wait 1 ms before changing APC mode */

    CSR_WRM(port_no, 
            VEN_REV(rev_a, VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0),
            VTSS_F_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_MODE(2),
            VTSS_M_VENICE_DEV1_32_SD10G65_APC_APC_COMMON_CFG0_APC_MODE);

    VTSS_I("Done Configure the APC: port %u",port_no);
    return VTSS_RC_OK;
}

static vtss_rc venice_sd10g_cfg(vtss_state_t *vtss_state, vtss_port_no_t port_no)
{
    vtss_phy_10g_mode_t *mode = &vtss_state->phy_10g_state[port_no].mode;
    u32 d_filter;

    /* Note the 10G Serdes are (and must be) synchronized with TN1052.*/
    if (vtss_state->phy_10g_state[port_no].mode.serdes_conf.use_conf) {
        d_filter  = vtss_state->phy_10g_state[port_no].mode.serdes_conf.d_filter;
    } else {
        d_filter  = 0x5DF828;
    }


    switch (mode->oper_mode) {
        case VTSS_PHY_LAN_MODE:
        case VTSS_PHY_LAN_SYNCE_MODE:
        case VTSS_PHY_LAN_MIXED_SYNCE_MODE:
            /********/
            /*  TX  */
            /********/
            VTSS_I("LAN MODE venice_sd10g_cfg: port %u", port_no);
            /* TX_RCPLL - Disable Loopback */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0,0,
                    VTSS_BIT(10) |  VTSS_BIT(11));

            /* TX_RCPLL - VCO_LOAD */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG1,
                    VTSS_ENCODE_BITFIELD(2,4,10),
                    VTSS_ENCODE_BITMASK(4,10));

            /* Filter settings */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2_D_FILTER(d_filter),
                    VTSS_M_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2_D_FILTER);

            /* TX_SYNTH_CFG0 - Bitgrouping is different in Rev B - HW is the same - No change from Rev A -> B */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0,
                    VTSS_ENCODE_BITFIELD(7,22,8) | /* synth_spare_pool */
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA(15),
                    VTSS_ENCODE_BITMASK(22,8) |    /* synth_spare_pool mask */
                    VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA);

            /* TX_SYNTH - LS_ENA */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA);

            /* TX_SYNTH */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL(47),
                    VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL);

            VTSS_MSLEEP(2); // Min from device reset

            /* Toggle HRATE  0->1->0 */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);

            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);

            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);

            VTSS_MSLEEP(2); // Done Toggling

            /* TX_PLLF_ENA */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0_PLLF_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0_PLLF_ENA);


            /********/
            /*  RX  */
            /********/

            /* RX_RCPLL - Disable Loopback */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,0,
                    VTSS_BIT(10) |  VTSS_BIT(11));

            /* RX_SBUS */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN);

            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    VTSS_ENCODE_BITFIELD(7,22,8) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA(15),
                    VTSS_ENCODE_BITMASK(22,8) |
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA);


            /* RX_RCPLL - VCO */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG1,
                    VTSS_ENCODE_BITFIELD(2,4,10),
                    VTSS_ENCODE_BITMASK(4,10));

            /* RX_SYNTH_CONFIG2  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA(54),
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA);


            /* RX_SYNTH_CDRLF  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL(47),
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL);

            /* IB_CFG2 / EQZ_GAIN */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN(300),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN);

            /* IB_CFG4  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_IB(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES2(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES1(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES0(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES(40) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES(23),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_IB |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES2 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES1 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES0);

            VTSS_MSLEEP(2); // Min from device reset

            /* IB_CFG3: Force signal detect high  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SET_SDET,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SET_SDET);

            /* IB_CFG5  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE(31),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE);

            /* IB_CFG8  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_CML_CURR(0),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_CML_CURR);

            /* Toggle HRATE  0->1->0 */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);

            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);

            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);

            VTSS_MSLEEP(2); // Done Toggling

            /* RX_PLLF_ENA */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA);

            VTSS_I("Done venice_sd10g_cfg: port %u", port_no);
            break;
        case VTSS_PHY_WAN_MODE:
        case VTSS_PHY_WAN_SYNCE_MODE:
        case VTSS_PHY_WAN_MIXED_SYNCE_MODE:
            /********/
            /*  TX  */
            /********/
            VTSS_I("WAN MODE venice_sd10g_cfg: port %u", port_no);
            /* TX_RCPLL - Disable Loopback */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0,0,
                    VTSS_BIT(10) |  VTSS_BIT(11));
            
            /* TX_RCPLL - VCO_LOAD */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG1,
                    VTSS_ENCODE_BITFIELD(2,4,10),
                    VTSS_ENCODE_BITMASK(4,10));
            
            /* Filter settings */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2_D_FILTER(d_filter),
                    VTSS_M_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2_D_FILTER);
            
            /* TX_SYNTH_CFG0 - Bitgrouping is different in Rev B - HW is the same - No change from Rev A -> B */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0,
                    VTSS_ENCODE_BITFIELD(7,22,8) | /* synth_spare_pool */
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA(15),
                    VTSS_ENCODE_BITMASK(22,8) |    /* synth_spare_pool mask */
                    VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA);
            
            /* TX_SYNTH - LS_ENA */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA);
            
            /* TX_SYNTH */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL(47),
                    VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL);
            
            VTSS_MSLEEP(2); // Min from device reset
            
            /* Toggle HRATE  0->1->0 */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
            
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
            
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
            
            VTSS_MSLEEP(2); // Done Toggling
            
            /* TX_PLLF_ENA */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0_PLLF_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0_PLLF_ENA);
            
            
            /********/
            /*  RX  */
            /********/
            
            /* RX_RCPLL - Disable Loopback */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,0,
                    VTSS_BIT(10) |  VTSS_BIT(11));
            
            /* RX_SBUS */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN);
            
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    VTSS_ENCODE_BITFIELD(7,22,8) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA(15),
                    VTSS_ENCODE_BITMASK(22,8) |
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA);
            
            
            /* RX_RCPLL - VCO */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG1,
                    VTSS_ENCODE_BITFIELD(2,4,10),
                    VTSS_ENCODE_BITMASK(4,10));
            
            /* RX_SYNTH_CONFIG2  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA(54),
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA);
            
            
            /* RX_SYNTH_CDRLF  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL(47),
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL);
            
            /* IB_CFG2 / EQZ_GAIN */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN(300),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN);
            
            /* IB_CFG4  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_IB(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES2(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES1(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES0(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES(40) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES(23),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_IB |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES2 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES1 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES0);
            
            VTSS_MSLEEP(2); // Min from device reset
            
            /* IB_CFG3: Force signal detect high  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SET_SDET,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SET_SDET);
            
            /* IB_CFG5  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE(31),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE);
            
            /* IB_CFG8  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_CML_CURR(0),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_CML_CURR);
            
            /* Toggle HRATE  0->1->0 */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
            
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
            
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
            
            VTSS_MSLEEP(2); // Done Toggling
            
            /* RX_PLLF_ENA */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA);
            
            VTSS_I("Done venice_sd10g_cfg WAN mode: port %u", port_no);
            break;
        case VTSS_PHY_1G_MODE:
            VTSS_I("1G MODE venice_sd10g_cfg: port %u", port_no);
            /********/
            /*  TX  */
            /********/
            /* TX_RCPLL - Disable Loopback */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0,0,
                    VTSS_BIT(10) |  VTSS_BIT(11));

            /* TX_RCPLL - VCO_LOAD */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG1,
                    VTSS_ENCODE_BITFIELD(2,4,10),
                    VTSS_ENCODE_BITMASK(4,10));

            /* TX_RCPLL - pll_lpf_cur, pll_vco_cur */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG2_PLL_LPF_CUR(0) |
                    VTSS_ENCODE_BITFIELD(15,2,5),
                    VTSS_M_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG2_PLL_LPF_CUR |
                    VTSS_ENCODE_BITMASK(2,5));

            /* TX_SYNTH_CFG0 */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0,
                    VTSS_ENCODE_BITFIELD(7,22,8) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA(15),
                    VTSS_ENCODE_BITMASK(22,8) |
                    VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA);

            /* TX_SYNTH - LS_ENA */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0,
                    0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA);

            /* TX_SYNTH */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL(47),
                    VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL);

            VTSS_MSLEEP(2); // Min from device reset

            /* BW_CDR_SEL A and B */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_A(2) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_B(2),
                    VTSS_M_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_A |
                    VTSS_M_VENICE_DEV1_32_SD10G65_DES_SD10G65_MOEBDIV_CFG0_MOEBDIV_BW_CDR_SEL_B);
            /* BW_CDR_SEL A and B */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_AMP_L(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_L0(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_L1(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_L2(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_AGC_L(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_AMP_C(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_C0(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_C1(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_C2(0)
                    ,
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_AMP_L |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_L0 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_L1 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_L2 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_AGC_L |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_AMP_C |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_C0 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_C1 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG1_IB_EQZ_C2
                   );
            /* IB_CFG2 / EQZ_GAIN */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN(400),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG2_IB_EQZ_GAIN);
            /* IB_CFG4  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_IB(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES2(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES1(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES0(0) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES(40) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES(23),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_H_THRES |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_VSCOPE_L_THRES |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_IB |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES2 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES1 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG4_IB_EQZ_C_ADJ_ES0);

            VTSS_MSLEEP(2); // Min from device reset
            /* IB_CFG3: Force signal detect high  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SET_SDET,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG3_IB_SET_SDET);

            /* IB_CFG5  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE(31),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG5_IB_OFFS_VALUE);

            /* IB_CFG6  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG6,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG6_IB_EQZ_GAIN_ADJ(70),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG6_IB_EQZ_GAIN_ADJ);

            /* IB_CFG8  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_CML_CURR(0),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG8_IB_CML_CURR);

            VTSS_MSLEEP(2); // Done Toggling

            /* TX_PLLF_ENA */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0_PLLF_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_TX_RCPLL_SD10G65_TX_RCPLL_CFG0_PLLF_ENA);
            /********/
            /*  RX  */
            /********/

            /* RX_RCPLL - Disable Loopback */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,0,
                    VTSS_BIT(10) |  VTSS_BIT(11));

            /* RX_SBUS */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN |
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_SPEED_SEL(3),
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_EN |
                   VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_SBUS_RX_CFG_SBUS_BIAS_SPEED_SEL);

            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0,
                    VTSS_ENCODE_BITFIELD(7,22,8) | /* synth_spare_pool */
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA(15) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_FB_STEP(3) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_P_STEP |
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA,
                    VTSS_ENCODE_BITMASK(22,8) |
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_OFF_COMP_ENA |
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_FB_STEP |
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_P_STEP |
                   VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);

            /* RX_RCPLL - VCO */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG1,
                    VTSS_ENCODE_BITFIELD(2,4,10),
                    VTSS_ENCODE_BITMASK(4,10));

            /* RX_SYNTH_CONFIG2  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA(64),
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_PHASE_DATA);

            /* RX_SYNTH_CDRLF  */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_MAX1(2) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_LIM(2) |
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL(47),
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_MAX1 |
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG1_LIM |
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL);

            /* pll_lpf_cur, pll_vco_cur (DBG) */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_CUR(0) |
                    VTSS_ENCODE_BITFIELD(15,2,5),
                    VTSS_M_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG2_PLL_LPF_CUR |
                   VTSS_ENCODE_BITMASK(2,5));

            VTSS_MSLEEP(2); // Done Toggling

            /* RX_PLLF_ENA */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA,
                    VTSS_F_VENICE_DEV1_32_SD10G65_RX_RCPLL_SD10G65_RX_RCPLL_CFG0_PLLF_ENA);
            break;
        default:
            VTSS_E("Serdes10g mode not supported");
            return VTSS_RC_ERROR;
    }

    VTSS_MSLEEP(100);
    return phy_10g_f2df_set(vtss_state, port_no);
}

static vtss_rc venice_sd6g_cfg(vtss_state_t *vtss_state, vtss_port_no_t port_no, vtss_serdes_mode_t mode)
{
    u32  ser_alisel, ob_ena_cas, pll_fsm_ctrl_data, ob_prec, ob_post0, i, ib_ini_lp, ib_max_lp, ib_min_lp;
    BOOL ser_enali, pll_ena_rot, hrate, qrate, ifmode, ilv_mode_ena;

    switch (mode) {
    case VTSS_SERDES_MODE_XAUI:
        ilv_mode_ena = 0;
        ob_post0 = 6;
        ob_prec = 0;
        pll_fsm_ctrl_data = 48;
        hrate = 1;
        qrate = 0;
        ifmode = 1;
        ob_ena_cas = 1;
        ser_alisel = 1;
        ser_enali = 1;
        pll_ena_rot = 1;
        break;
    case VTSS_SERDES_MODE_RXAUI:
        ilv_mode_ena = 1;
        ob_post0 = 1;
        ob_prec = 5;
        pll_fsm_ctrl_data = 96;
        hrate = 0;
        qrate = 0;
        ifmode = 3;
        ob_ena_cas = 1;
        ser_alisel = 1;
        ser_enali = 1;
        pll_ena_rot = 1;
        break;
    case VTSS_SERDES_MODE_SGMII:
        ilv_mode_ena = 0;
        ob_post0 = 0;
        ob_prec = 0;
        pll_fsm_ctrl_data = 60;
        hrate = 0;
        qrate = 1;
        ifmode = 1;
        ob_ena_cas = 2;
        ser_alisel = 0;
        ser_enali = 0;
        pll_ena_rot = 0;
        break;
    default:
        VTSS_E("Serdes6g mode not supported:%u",mode);
        return VTSS_RC_ERROR;
    }
    /* The following settings are synchronized with TN1052. */
    VTSS_I("Configure the Serdes6G port:%u", port_no);
    if (vtss_state->phy_10g_state[port_no].mode.serdes_conf.use_conf) {
        ib_ini_lp = vtss_state->phy_10g_state[port_no].mode.serdes_conf.ib_ini_lp;
        ib_max_lp = vtss_state->phy_10g_state[port_no].mode.serdes_conf.ib_max_lp;
        ib_min_lp = vtss_state->phy_10g_state[port_no].mode.serdes_conf.ib_min_lp;
    } else {
        ib_ini_lp = 0xC;
        ib_max_lp = 0x3F;
        ib_min_lp = 0xA;
    }

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_RTRM_ADJ(13),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_RTRM_ADJ);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_DES_CFGA,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_DES_CFGA_DES_PHS_CTRL(2),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_DES_CFGA_DES_PHS_CTRL);

    CSR_WRM(port_no, VTSS_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_INTERLEAVE_MODE_CFG,
            (ilv_mode_ena ? VTSS_F_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_INTERLEAVE_MODE_CFG_ILV_MODE_ENA : 0),
            VTSS_F_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_INTERLEAVE_MODE_CFG_ILV_MODE_ENA);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_MACRO_CTRL_CFG_MACRO_CTRL_FSM_CFG3,
            0,
            VTSS_M_VENICE_DEV4_MACRO_CTRL_CFG_MACRO_CTRL_FSM_CFG3_LANE_ENA_MAN);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_ENA_LANE,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_ENA_LANE);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_SER_CFG,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_SER_CFG_SER_ALISEL(ser_alisel) |
            (ser_enali ? VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_SER_CFG_SER_ENALI : 0),
            VTSS_BIT(8) /* SER_4TAP_ENA=0 */ |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_SER_CFG_SER_ALISEL |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_SER_CFG_SER_ENALI);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A_OB_ENA1V_MODE |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A_OB_POL  |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A_OB_POST0(ob_post0) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A_OB_PREC(ob_prec),
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A_OB_ENA1V_MODE |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A_OB_POL  |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A_OB_POST0 |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A_OB_PREC);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG1,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG1_OB_ENA_CAS(ob_ena_cas),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG1_OB_ENA_CAS);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_GP_CFGB,
            VTSS_BIT(8) | VTSS_BIT(9), // SNFBC='b8 / SNFBV='b9
            VTSS_BIT(8) | VTSS_BIT(9));

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA_PLL_ENA_OFFS(3) |
//            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA_PLL_DIV4 = 0
            (pll_ena_rot ? VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA_PLL_ENA_ROT : 0),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA_PLL_ENA_OFFS |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA_PLL_DIV4 |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA_PLL_ENA_ROT);


    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB_PLL_FSM_CTRL_DATA(pll_fsm_ctrl_data) |
//            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB_PLL_ROT_DIR = 0
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB_PLL_ROT_FRQ,
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB_PLL_FSM_CTRL_DATA |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB_PLL_FSM_ENA |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB_PLL_ROT_DIR |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB_PLL_ROT_FRQ);


    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_SYS_RST,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_SYS_RST);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB,
            (hrate ? VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_HRATE : 0) |
            (qrate ? VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_QRATE : 0) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_IF_MODE(ifmode),
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_HRATE |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_QRATE |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_IF_MODE);

    /* Enable PLL_CFGB */
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB_PLL_FSM_ENA,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGB_PLL_FSM_ENA);

    VTSS_MSLEEP(20);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_VBULK_SEL |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_ICML_ADJ(5) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_SIG_DET_CLK_SEL(0),
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_VBULK_SEL |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_ICML_ADJ |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_SIG_DET_CLK_SEL);


    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_HP(1) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_MID(1) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_LP(2) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_OFFSET(0),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_HP |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_MID |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_LP |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_OFFSET);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1A,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1A_IB_TJTAG(8) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1A_IB_TSDET(16),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1A_IB_TJTAG |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1A_IB_TSDET);


    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_SCALY(15),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_SCALY |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_FRC_HP |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_FRC_MID |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_FRC_LP |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_FRC_OFFSET);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2A,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2A_IB_TINFV(3) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2A_IB_OINFI(31) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2A_IB_OINFS(7),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2A_IB_TINFV |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2A_IB_OINFI |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2A_IB_OINFS);


    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2B_IB_OCALS(32) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2B_IB_TCALV(12) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2B_IB_UMAX(2) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2B_IB_UREG(4),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2B_IB_OCALS |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2B_IB_TCALV |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2B_IB_UMAX |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG2B_IB_UREG);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG3A,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG3A_IB_INI_MID(31),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG3A_IB_INI_MID);


    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG3B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG3B_IB_INI_LP(ib_ini_lp) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG3B_IB_INI_OFFSET(31),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG3B_IB_INI_LP |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG3B_IB_INI_OFFSET);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4A,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4A_IB_MAX_HP(63) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4A_IB_MAX_MID(63),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4A_IB_MAX_HP |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4A_IB_MAX_MID);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4B_IB_MAX_LP(ib_max_lp) |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4B_IB_MAX_OFFSET(63),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4B_IB_MAX_LP |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG4B_IB_MAX_OFFSET);

    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG5B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG5B_IB_MIN_LP(ib_min_lp),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG5B_IB_MIN_LP);

    /* Start calibration workaround */
    /* Switch cal clk source to SW */
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_FRC_OFFSET |
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_SCALY(0),
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_FRC_OFFSET |
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_SCALY);

    /* start calibration */
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B,
            0,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_CAL_ENA);
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_CAL_ENA,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_CAL_ENA);

    CSR_WR(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_GP_CFGB, 0);

    /* 11 clock cycles via SW */
    for (i=0; i<11; i++) {
        CSR_WR(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_GP_CFGB, 1);
        CSR_WR(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_GP_CFGB, 0);
    }
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B,
            0,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_FRC_OFFSET);
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_SCALY(15),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1B_IB_SCALY);
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B,
            0,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_CAL_ENA);
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_CAL_ENA,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_CAL_ENA);

    /* End calibration workaround */
    VTSS_MSLEEP(15);

    /* Calibration is done, set the TSDET to 5  */
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1A,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1A_IB_TSDET(5),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG1A_IB_TSDET);

    /* Set the SIG_DET_CLK_SEL as described in TN1052 */
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_SIG_DET_CLK_SEL(7),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0A_IB_SIG_DET_CLK_SEL);

    /* Set pat_set_offset to 1 */
    CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B,
            VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_OFFSET(1),
            VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_IB_CFG0B_IB_REG_PAT_SEL_OFFSET);

    return VTSS_RC_OK;
}

static vtss_rc venice_pcs1g_cfg(vtss_state_t *vtss_state, vtss_port_no_t port_no)
{
    vtss_phy_10g_mode_t *mode = &vtss_state->phy_10g_state[port_no].mode;

    switch (mode->oper_mode) {
        case VTSS_PHY_1G_MODE:
            /* Line side */
            /*************/
            /* enable PCS1G */
            CSR_WRM(port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_CFG,
                    VTSS_F_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_CFG_PCS_ENA,
                    VTSS_F_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_CFG_PCS_ENA);
            /* Disable ANEG */
            CSR_WRM(port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG,
                    0,
                    VTSS_F_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_ANEG_ENA |
                    VTSS_F_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_SW_RESOLVE_ENA);
            /* Force Sigdet to 1 (recommended by HW designers) */
            CSR_WRM(port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_SD_CFG,
                    0,
                    VTSS_F_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_SD_CFG_SD_ENA);
            /* Host side */
            /*************/
            /* enable PCS1G */
            CSR_WRM(port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG,
                    VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG_PCS_ENA,
                    VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG_PCS_ENA);
            /* Disable ANEG */
            CSR_WRM(port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG,
                    0,
                    VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_ANEG_ENA |
                    VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_SW_RESOLVE_ENA);
            /* Force Sigdet to 1 (recommended by HW designers) */
            CSR_WRM(port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_SD_CFG,
                    0,
                    VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_SD_CFG_SD_ENA);

            /* Set up basic flow control according to TGS1003 section 5.2 */
            CSR_WRM(port_no, VTSS_FC_BUFFER_CONFIG_FC_MODE_CFG,
                    VTSS_F_FC_BUFFER_CONFIG_FC_MODE_CFG_PAUSE_REACT_ENA |
                    VTSS_F_FC_BUFFER_CONFIG_FC_MODE_CFG_PAUSE_GEN_ENA |
                    VTSS_F_FC_BUFFER_CONFIG_FC_MODE_CFG_INCLUDE_PAUSE_RCVD_IN_PAUSE_GEN,
                    VTSS_F_FC_BUFFER_CONFIG_FC_MODE_CFG_PAUSE_REACT_ENA |
                    VTSS_F_FC_BUFFER_CONFIG_FC_MODE_CFG_PAUSE_GEN_ENA |
                    VTSS_F_FC_BUFFER_CONFIG_FC_MODE_CFG_INCLUDE_PAUSE_RCVD_IN_PAUSE_GEN);
            CSR_WRM(port_no, VTSS_FC_BUFFER_CONFIG_TX_CTRL_QUEUE_CFG,
                    VTSS_F_FC_BUFFER_CONFIG_TX_CTRL_QUEUE_CFG_TX_CTRL_QUEUE_START(0) |
                    VTSS_F_FC_BUFFER_CONFIG_TX_CTRL_QUEUE_CFG_TX_CTRL_QUEUE_END(63),
                    VTSS_M_FC_BUFFER_CONFIG_TX_CTRL_QUEUE_CFG_TX_CTRL_QUEUE_START |
                    VTSS_M_FC_BUFFER_CONFIG_TX_CTRL_QUEUE_CFG_TX_CTRL_QUEUE_END);
            CSR_WRM(port_no, VTSS_FC_BUFFER_CONFIG_TX_DATA_QUEUE_CFG,
                    VTSS_F_FC_BUFFER_CONFIG_TX_DATA_QUEUE_CFG_TX_DATA_QUEUE_START(64) |
                    VTSS_F_FC_BUFFER_CONFIG_TX_DATA_QUEUE_CFG_TX_DATA_QUEUE_END(5119),
                    VTSS_M_FC_BUFFER_CONFIG_TX_DATA_QUEUE_CFG_TX_DATA_QUEUE_START |
                    VTSS_M_FC_BUFFER_CONFIG_TX_DATA_QUEUE_CFG_TX_DATA_QUEUE_END);

            VTSS_MSLEEP(100);            

            break;
        default:
            VTSS_D("pcs1g disable");
            /* disable PCS1G */
            CSR_WRM(port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_CFG,
                    0,
                    VTSS_F_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_CFG_PCS_ENA);
            CSR_WRM(port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG,
                    0,
                    VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG_PCS_ENA);
            break;
    }
    return VTSS_RC_OK;
}

static vtss_port_no_t base_port(vtss_state_t *vtss_state, vtss_port_no_t port_no)
{
    return vtss_state->phy_10g_state[port_no].phy_api_base_no;
}

static vtss_rc phy_10g_mode_conf_set(vtss_state_t *vtss_state,
                                     vtss_port_no_t port_no)
{
    vtss_serdes_mode_t serdes_mode = VTSS_SERDES_MODE_XAUI;
    vtss_phy_10g_mode_t *mode = &vtss_state->phy_10g_state[port_no].mode;
    VTSS_I("phy_10g_mode_conf_set - Reset:%u\n",port_no);

    if (mode->interface == VTSS_PHY_XAUI_XFI) {
        serdes_mode = VTSS_SERDES_MODE_XAUI;
    } else if (mode->interface == VTSS_PHY_RXAUI_XFI) {
        VTSS_E("Serdes Mode currently not supported");
    } else if ((mode->interface == VTSS_PHY_SGMII_LANE_0_XFI) || (mode->interface == VTSS_PHY_SGMII_LANE_3_XFI) || (mode->oper_mode == VTSS_PHY_1G_MODE)) {
        VTSS_D("Serdes Mode VTSS_SERDES_MODE_SGMII");
        serdes_mode = VTSS_SERDES_MODE_SGMII;
    } else {
        VTSS_E("Serdes Mode not supported");
        return VTSS_RC_ERROR;
    }

    if (mode->oper_mode == VTSS_PHY_1G_MODE) {
        VTSS_D("Serdes Mode VTSS_SERDES_MODE_SGMII");
        serdes_mode = VTSS_SERDES_MODE_SGMII;
    }

    /* Block level reset, not using WRM here because all bits in this register are One-shot */
    CSR_WR(port_no, VTSS_VENICE_DEV1_BLOCK_LEVEL_RESET_BLOCK_LEVEL_RESET1,
           VTSS_F_VENICE_DEV1_BLOCK_LEVEL_RESET_BLOCK_LEVEL_RESET1_HOST_1G_PCS_INGR_RESET |
           VTSS_F_VENICE_DEV1_BLOCK_LEVEL_RESET_BLOCK_LEVEL_RESET1_FIFO_INGR_RESET |
           VTSS_F_VENICE_DEV1_BLOCK_LEVEL_RESET_BLOCK_LEVEL_RESET1_HOST_MAC_INGR_RESET |
           VTSS_F_VENICE_DEV1_BLOCK_LEVEL_RESET_BLOCK_LEVEL_RESET1_LINE_MAC_INGR_RESET |
           VTSS_F_VENICE_DEV1_BLOCK_LEVEL_RESET_BLOCK_LEVEL_RESET1_LINE_10G_PCS_INGR_RESET |
           VTSS_F_VENICE_DEV1_BLOCK_LEVEL_RESET_BLOCK_LEVEL_RESET1_LINE_1G_PCS_INGR_RESET |
           VTSS_F_VENICE_DEV1_BLOCK_LEVEL_RESET_BLOCK_LEVEL_RESET1_WIS_INGR_RESET |
           VTSS_F_VENICE_DEV1_BLOCK_LEVEL_RESET_BLOCK_LEVEL_RESET1_PMA_INGR_RESET);
    VTSS_MSLEEP(10);

    if (port_no == vtss_state->phy_10g_state[port_no].phy_api_base_no) {
        CSR_WRM(base_port(vtss_state, port_no), VTSS_VENICE_GLOBAL_POR_STATUS_POR_DONE,
                VTSS_F_VENICE_GLOBAL_POR_STATUS_POR_DONE_POR_DONE,
                VTSS_F_VENICE_GLOBAL_POR_STATUS_POR_DONE_POR_DONE);

        VTSS_MSLEEP(10);

        CSR_WRM(base_port(vtss_state, port_no), VTSS_LINE_PLL5G_L_PLL5G_L_PLL5G_CFG4A,
                VTSS_F_LINE_PLL5G_L_PLL5G_L_PLL5G_CFG4A_IB_CTRL(0x7600),
                VTSS_M_LINE_PLL5G_L_PLL5G_L_PLL5G_CFG4A_IB_CTRL);

        CSR_WRM(base_port(vtss_state, port_no), VTSS_HOST_PLL5G_H_PLL5G_H_PLL5G_CFG0B,
                VTSS_F_HOST_PLL5G_H_PLL5G_H_PLL5G_CFG0B_SELBGV820(4),
                VTSS_M_HOST_PLL5G_H_PLL5G_H_PLL5G_CFG0B_SELBGV820);

        CSR_WRM(base_port(vtss_state, port_no), VTSS_LINE_PLL5G_L_PLL5G_L_PLL5G_CFG0B,
                VTSS_F_LINE_PLL5G_L_PLL5G_L_PLL5G_CFG0B_SELBGV820(4),
                VTSS_M_LINE_PLL5G_L_PLL5G_L_PLL5G_CFG0B_SELBGV820);
    }

    /* Set the APC into a proper mode before calibration (rev_a and rev_b are different) */
    VTSS_RC(venice_apc_setup_rx(vtss_state, port_no));
    /* Calibrate the APC IB */
    VTSS_RC(venice_apc_calibrate_ib(vtss_state, port_no));
    /* calculate the sref clock settings */
    switch (mode->oper_mode) {
        case VTSS_PHY_LAN_MODE:
            vtss_state->phy_10g_state[port_no].srefclk.enable = FALSE;
            vtss_state->phy_10g_state[port_no].srefclk.freq = VTSS_PHY_10G_SREFCLK_156_25;
            break;
        case VTSS_PHY_WAN_MODE:
            vtss_state->phy_10g_state[port_no].srefclk.enable = FALSE;
            vtss_state->phy_10g_state[port_no].srefclk.freq = VTSS_PHY_10G_SREFCLK_155_52;
            break;
        case VTSS_PHY_1G_MODE:
            vtss_state->phy_10g_state[port_no].srefclk.enable = FALSE;
            vtss_state->phy_10g_state[port_no].srefclk.freq = VTSS_PHY_10G_SREFCLK_125_00;
            break;
        case VTSS_PHY_LAN_SYNCE_MODE:
        case VTSS_PHY_LAN_MIXED_SYNCE_MODE:
            if (mode->hl_clk_synth) {
                vtss_state->phy_10g_state[port_no].srefclk.enable = FALSE;
            } else {
                vtss_state->phy_10g_state[port_no].srefclk.enable = TRUE;
            }
            vtss_state->phy_10g_state[port_no].srefclk.freq = VTSS_PHY_10G_SREFCLK_156_25;
            break;
        case VTSS_PHY_WAN_SYNCE_MODE:
        case VTSS_PHY_WAN_MIXED_SYNCE_MODE:
            if (mode->hl_clk_synth) {
                vtss_state->phy_10g_state[port_no].srefclk.enable = FALSE;
            } else {
                vtss_state->phy_10g_state[port_no].srefclk.enable = TRUE;
                VTSS_D("Dual clock WAN mode %u\n",port_no);
            }
            vtss_state->phy_10g_state[port_no].srefclk.freq = VTSS_PHY_10G_SREFCLK_155_52;
            break;
    }
    
    VTSS_I("Apply ROM engine port:%u:\n",port_no);
    /* Apply internal ROM settings. This speeds up the configuration.  */
    switch (mode->oper_mode) {
        case VTSS_PHY_LAN_MODE:
        case VTSS_PHY_LAN_SYNCE_MODE:
        case VTSS_PHY_LAN_MIXED_SYNCE_MODE:
            /* clear 1G mode */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE,
                    0,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_ETH_1G_ENA |
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_SEL_1G_LANE_3);
            CSR_WRM(port_no, VTSS_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_USR_10G_LAN,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_USR_10G_LAN);
            break;
        case VTSS_PHY_WAN_MODE:
        case VTSS_PHY_WAN_SYNCE_MODE:
        case VTSS_PHY_WAN_MIXED_SYNCE_MODE:
            /* clear 1G mode */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE,
                    0,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_ETH_1G_ENA |
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_SEL_1G_LANE_3);
            CSR_WRM(port_no, VTSS_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_USR_10G_WAN,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_USR_10G_WAN);
            break;
        case VTSS_PHY_1G_MODE:
            /* enter 1G mode */
            CSR_WRM(port_no, VTSS_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_ETH_1G_ENA |
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_SEL_1G_LANE_3,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_ETH_1G_ENA |
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_SEL_1G_LANE_3);
            CSR_WRM(port_no, VTSS_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_USR_1G,
                    VTSS_F_VENICE_DEV1_DATAPATH_CONTROL_DATAPATH_MODE_USR_1G);
            break;
    }

    VTSS_MSLEEP(10);

    VTSS_D("oper_mode = %d, serdes_mode = %d", mode->oper_mode, serdes_mode);
    /* Configure Serdes 10G into wanted mode (TN1052) */
    VTSS_RC(venice_sd10g_cfg(vtss_state, port_no));
    /* Configure the APC (TN1052) */
    VTSS_RC(venice_apc_cfg(vtss_state, port_no));
    /* Configure Serdes 6G */
    VTSS_RC(venice_sd6g_cfg(vtss_state, port_no, serdes_mode));
    /* Configure pcs1g - if VTSS_PHY_1G_MODE is chosen */
    VTSS_RC(venice_pcs1g_cfg(vtss_state, port_no));
    CSR_WRM(port_no, VTSS_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_SD_CFG,
            0, //            VTSS_F_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_SD_CFG_SD_ENA = 0
            VTSS_F_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_SD_CFG_SD_ENA);

    VTSS_D("GPIO setup is left over to the applications that uses the pins");

    /* Apply ref clock and recovered clock outputs.  */
    VTSS_RC(phy_10g_srefclk_set(vtss_state, port_no));
    VTSS_RC(phy_10g_rxckout_set(vtss_state, port_no));
    VTSS_RC(phy_10g_txckout_set(vtss_state, port_no));

    VTSS_I("Serdes config complete port %u\n",port_no);

    // FRC_DIS
    VTSS_RC(csr_wrm(vtss_state, PHY_BASE_PORT(port_no), MMD_GLOBAL, 0, 0x280, 0,  1));
#if defined(VTSS_FEATURE_MACSEC)
    if (is_macsec_capable(vtss_state, port_no)) {
        VTSS_RC(vtss_macsec_speed_conf_priv(vtss_state, port_no));
    }
#endif
#ifdef VTSS_FEATURE_10GBASE_KR
    VTSS_RC(phy_10g_kr_conf_init(vtss_state, port_no));
#endif
    if (mode->oper_mode == VTSS_PHY_1G_MODE) {
        // Clear all Interrupts
        CSR_WR(port_no, VTSS_VENICE_WIS_EWIS_Interrupt_Mask_1_EWIS_INTR_MASKA_1, 0);
        CSR_WR(port_no, VTSS_VENICE_WIS_EWIS_Interrupt_Mask_1_EWIS_INTR_MASKB_1, 0);
        CSR_WR(port_no, VTSS_VENICE_WIS_EWIS_Interrupt_Mask_2_EWIS_INTR_MASKA_2, 0);
        CSR_WR(port_no, VTSS_VENICE_WIS_EWIS_Interrupt_Mask_2_EWIS_INTR_MASKB_2, 0);
        CSR_WR(port_no, VTSS_VENICE_WIS_EWIS_Interrupt_Mask_3_EWIS_INTR_MASKA_3, 0);
        CSR_WR(port_no, VTSS_VENICE_WIS_EWIS_Interrupt_Mask_3_EWIS_INTR_MASKB_3, 0);
    }
    return VTSS_RC_OK;
}

static vtss_rc phy_10g_loopback_set(struct vtss_state_s *vtss_state,
                                                vtss_port_no_t port_no)
{
    vtss_phy_10g_loopback_t *loopback = &vtss_state->phy_10g_state[port_no].loopback;
    vtss_phy_10g_srefclk_mode_t srefclk = vtss_state->phy_10g_state[port_no].srefclk;
    u32 reg, pll_ena_rot;
    u32 value;
    vtss_rc rc = VTSS_RC_OK;
    vtss_phy_10g_srefclk_mode_t srefclk_disable;
    vtss_port_no_t          pma_port = pma_port_no(vtss_state, port_no);

    VTSS_D("Enter");

    /* System */
    switch (loopback->lb_type) {
        case VTSS_LB_SYSTEM_PCS_DEEP:
        case VTSS_LB_H3:                  /* Host Loopback 3, 64-bit PCS after the gearbox FF00 repeating IEEE PCS system loopback */
            /* = mode G, Venice name: H3 */
            CSR_WRM(port_no, VTSS_VENICE_PCS_PCS_Control_1_PCS_Control_1,
                    loopback->enable ? VTSS_F_VENICE_PCS_PCS_Control_1_PCS_Control_1_PCS_System_loopback : 0,
                    VTSS_F_VENICE_PCS_PCS_Control_1_PCS_Control_1_PCS_System_loopback);
            VTSS_I("Loopback type H3, enable = %d", loopback->enable);
            break;
        case VTSS_LB_SYSTEM_PMA:
        case VTSS_LB_H4:                  /* Host Loopback 4, 64-bit WIS FF00 repeating IEEE WIS system loopback */
            /* mode J, Venice name: H4 */
            CSR_WRM(port_no, VTSS_VENICE_WIS_WIS_Control_1_WIS_CTRL1,
                    loopback->enable ? VTSS_F_VENICE_WIS_WIS_Control_1_WIS_CTRL1_LPBK_H4 : 0,
                    VTSS_F_VENICE_WIS_WIS_Control_1_WIS_CTRL1_LPBK_H4); /* Loopback J (resides on the WIS block) */
            VTSS_I("Loopback type H4, enable = %d", loopback->enable);
            break;
        case VTSS_LB_NETWORK_PCS:
        case VTSS_LB_L2:                  /* Line Loopback 2, 64-bit XGMII after FIFO Mirror SFP+ data */
            /* mode F, Venice name: L2 */
            CSR_WRM(port_no, VTSS_FIFO_BIST_Datapath_Control_Datapath_Control,
                    loopback->enable ? VTSS_F_FIFO_BIST_Datapath_Control_Datapath_Control_LOOP_L2_ENA : 0,
                    VTSS_F_FIFO_BIST_Datapath_Control_Datapath_Control_LOOP_L2_ENA); /* Loopback F */
            VTSS_I("Loopback type L2, enable = %d", loopback->enable);
            break;
        case VTSS_LB_SYSTEM_XS_SHALLOW:     /* System Loopback B = */
        case VTSS_LB_H2:                  /* Host Loopback 2, 40-bit XAUI-PHY interface Mirror XAUI data */
            CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA, &reg)
            pll_ena_rot = reg & VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA_PLL_ENA_ROT ? 1 : 0;
            CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_SER_CFG,
                    VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_SER_CFG_SER_ALISEL(loopback->enable ? 0 : pll_ena_rot),
                    VTSS_M_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_SER_CFG_SER_ALISEL);
            CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB,
                    loopback->enable ? VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_ENA_FLOOP : 0,
                    VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_ENA_FLOOP);
            VTSS_I("Loopback type H2, enable = %d", loopback->enable);
            break;
        case VTSS_LB_H5:                  /* Host Loopback 5, 1-bit SFP+ after SerDes Mirror XAUI data IEEE PMA system loopback */
            // H5 is in the PMA block, therefore PMA port is used
            CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_SIG_SEL(loopback->enable ? 2 : 0),
                    VTSS_M_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_SIG_SEL);
            CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10,
                    loopback->enable ? VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10_IB_LOOP_REC : 0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10_IB_LOOP_REC);
            CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0,
                    loopback->enable ? VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_PAD_LOOP : 0,
                    VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_PAD_LOOP);
            VTSS_I("Loopback type H5, enable = %d", loopback->enable);
            break;
        case VTSS_LB_H6:                  /* Host Loopback 6, 32-bit XAUI-PHY interface Mirror XAUI data */
            CSR_WRM(port_no, VTSS_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_CFG2,
                    loopback->enable ? VTSS_F_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_CFG2_LINE_LOOP_ENA : 0,
                    VTSS_F_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_CFG2_LINE_LOOP_ENA);
            VTSS_I("Loopback type H6, enable = %d", loopback->enable);
            break;
        case VTSS_LB_L0:                  /* Line Loopback 0, 4-bit XAUI before SerDes Mirror SFP+ data */
            CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB,
                    loopback->enable ? VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_ENA_PLOOP : 0,
                    VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_ENA_PLOOP);
            VTSS_I("Loopback type L0, enable = %d", loopback->enable);
            break;
        case VTSS_LB_NETWORK_XS_DEEP:     /* Network Loopback A = */
        case VTSS_LB_L1:                  /* Line Loopback 1, 4-bit XAUI after SerDes Mirror SFP+ data IEEE PHY-XS network loopback */
            CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB,
                    loopback->enable ? VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_ENA_ELOOP : 0,
                    VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB_ENA_ELOOP);
            VTSS_I("Loopback type L1, enable = %d", loopback->enable);
            break;
        case VTSS_LB_NETWORK_PMA:         /* Network Loopback K = */
        case VTSS_LB_L3:                  /* Line Loopback 3, 64-bit PMA interface Mirror SFP+ data */
            // L3 is in the PMA block, therefore PMA port is used
            if (loopback->enable) {
                if (srefclk.enable) {
                    // cannot lock to srefclk in L3 mode, therefore disable srefclk setting
                    srefclk_disable.enable = FALSE;
                    srefclk_disable.freq = VTSS_PHY_10G_SREFCLK_156_25;
                    VTSS_RC(phy_10g_srefclk_set_internal(vtss_state, pma_port, &srefclk_disable));
                }
                // L3 loopback enable (facility loopback):
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_LOOPBACK_CONTROL_PMA_LOOPBACK_CONTROL,
                        VTSS_F_VENICE_DEV1_LOOPBACK_CONTROL_PMA_LOOPBACK_CONTROL_L3_CONTROL,
                        VTSS_F_VENICE_DEV1_LOOPBACK_CONTROL_PMA_LOOPBACK_CONTROL_L3_CONTROL);
                // Select source for synchronization:
                CSR_WRM(pma_port,VTSS_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG,
                        VTSS_F_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC(vtss_state->phy_10g_state[port_no].channel_id),
                        VTSS_M_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC);
                // Adjust filter bandwidth in Rx and Tx macro:
                CSR_RD(pma_port, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF, &value);
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1,
                        VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL(VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL(value)),
                        VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1_SYNC_CTRL_FSEL);
                //Add a small frequency offset to Rx and Tx macro (set bit 1 in loopback mode):
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                        VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT(
                            rx_tx_synth_freq_mult_l3[phy_10g_rx_tx_reg_mode_idx(vtss_state, pma_port)]),
                        VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT);
                //sd10g65_(r/t)x_synth_cfg3 :
                CSR_WR(pma_port, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG3,
                        rx_tx_synth_freqm_0_l3[phy_10g_rx_tx_reg_mode_idx(vtss_state, pma_port)]);
                CSR_WR(pma_port, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG3,
                       rx_tx_synth_freqm_0_l3[phy_10g_rx_tx_reg_mode_idx(vtss_state, pma_port)]);
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1,
                        VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT(
                        rx_tx_synth_freq_mult_l3[phy_10g_rx_tx_reg_mode_idx(vtss_state, pma_port)]),
                        VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT);
                // Reset integrators synchronized
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                        VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E(1),
                        VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E);
                // Enable lane synchronization in Tx macro:
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0,
                        VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA,
                        VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA);
                // Start integrators synchronized
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                        VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E(3),
                        VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E);
                
            } else {
                //Add a small frequency offset to Rx and Tx macro (clear bit 1 in normal mode):
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1,
                        VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT(
                            rx_tx_synth_freq_mult_norm[phy_10g_rx_tx_reg_mode_idx(vtss_state, pma_port)]),
                        VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1_SYNTH_FREQ_MULT);
                //sd10g65_rx_synth_cfg3 :
                CSR_WR(pma_port, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG3,
                       rx_tx_synth_freqm_0_norm[phy_10g_rx_tx_reg_mode_idx(vtss_state, pma_port)]);
                CSR_WR(pma_port, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG3,
                       rx_tx_synth_freqm_0_norm[phy_10g_rx_tx_reg_mode_idx(vtss_state, pma_port)]);

                CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1,
                        VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT(
                        rx_tx_synth_freq_mult_norm[phy_10g_rx_tx_reg_mode_idx(vtss_state, pma_port)]),
                        VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT);
                
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_LOOPBACK_CONTROL_PMA_LOOPBACK_CONTROL,
                        0,
                        VTSS_F_VENICE_DEV1_LOOPBACK_CONTROL_PMA_LOOPBACK_CONTROL_L3_CONTROL);
                CSR_WRM(pma_port,VTSS_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG,
                        VTSS_F_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC(3),
                        VTSS_M_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC);
                // Restore to default
                CSR_WRM(pma_port, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2,
                        VTSS_F_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E(0),
                        VTSS_M_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E);
                // restore sfreclk mode
                if (srefclk.enable) {
                    VTSS_RC(phy_10g_srefclk_set(vtss_state, pma_port));
                }
            }
            VTSS_I("Loopback type L3, enable = %d", loopback->enable);
            break;
        case VTSS_LB_NONE:
            break;
        default:
            /* Some loopbacks are not availble in Venice family */
            VTSS_I("Loopback type is not supported for chip:%d\n",vtss_state->phy_10g_state[port_no].type);
            rc = VTSS_RC_ERROR;
            break;
    }
    VTSS_D("Exit");
    return rc;
}

static void venice_debug_reg_header(const vtss_debug_printf_t pr, const char *name)
{
    char buf[80];

    sprintf(buf, "%-45s  Tgt   Addr  ", name);
    vtss_debug_print_reg_header(pr, buf);
}

#define VENICE_GET_BIT(tgt, addr, fld, value)  (VTSS_F_##tgt##_##addr##_##fld & (value) ? 1 : 0)
#define VENICE_GET_FLD(tgt, addr, fld, value)  VTSS_X_##tgt##_##addr##_##fld(value)
#define VENICE_DEBUG_SD6G_BIT(pr, addr, fld, value)  pr(" %-20s: %u\n", #fld, VENICE_GET_BIT(VENICE_DEV4, addr, fld, value));
#define VENICE_DEBUG_SD6G_FLD(pr, addr, fld, value)  pr(" %-20s: %u\n", #fld, VENICE_GET_FLD(VENICE_DEV4, addr, fld, value));
#define VENICE_DEBUG_SD6GL_BIT(pr, addr, fld, value, value1, value2, value3)  pr(" %-20s: %u  %u  %u  %u\n", #fld, VENICE_GET_BIT(VENICE_DEV4, addr, fld, value),VENICE_GET_BIT(VENICE_DEV4, addr, fld, value1),VENICE_GET_BIT(VENICE_DEV4, addr, fld, value2),VENICE_GET_BIT(VENICE_DEV4, addr, fld, value3));
#define VENICE_DEBUG_SD6GL_FLD(pr, addr, fld, value, value1, value2, value3)  pr(" %-20s: %u  %u  %u  %u\n", #fld, VENICE_GET_FLD(VENICE_DEV4, addr, fld, value),VENICE_GET_FLD(VENICE_DEV4, addr, fld, value1),VENICE_GET_FLD(VENICE_DEV4, addr, fld, value2),VENICE_GET_FLD(VENICE_DEV4, addr, fld, value3));
#define VENICE_DEBUG_XAUI_BIT(pr, addr, fld, value)  pr(" %-20s: %u\n", #fld, VENICE_GET_BIT(PCS_XAUI, addr, fld, value));
#define VENICE_DEBUG_XAUI_FLD(pr, addr, fld, value)  pr(" %-20s: 0x%x\n", #fld, VENICE_GET_FLD(PCS_XAUI, addr, fld, value));


static void venice_deb_pr_reg(vtss_state_t *vtss_state, const vtss_debug_printf_t pr, vtss_port_no_t port_no,
                              ioreg_blk *io, const char *name, u32 *value)
{
    char buf[80];

    (void)_csr_rd(vtss_state, port_no, io, value);
    sprintf(buf, "%-45s  0x%02x  0x%04x", name, io->mmd, io->addr);
    vtss_debug_print_reg(pr, buf, *value);
}

vtss_rc vtss_phy_10g_debug_info_print(vtss_state_t              *vtss_state,
                                      const vtss_debug_printf_t pr,
                                      const vtss_debug_info_t   *const info,
                                      BOOL                      ail)
{
    vtss_port_no_t        port_no;
    vtss_phy_10g_port_state_t *ps;
    char buf[32];
    u32 value, lane0,lane1,lane2,lane3;

    if (!vtss_debug_group_enabled(pr, info, VTSS_DEBUG_GROUP_PHY) || ail) {
        return VTSS_RC_OK;
    }
   
    for (port_no = VTSS_PORT_NO_START; port_no < vtss_state->port_count; port_no++) {
        ps = &vtss_state->phy_10g_state[port_no];
        if (!info->port_list[port_no] || ps->type == VTSS_PHY_TYPE_10G_NONE) {
            continue;
        }
        sprintf(buf, "PORT %d", port_no);
        venice_debug_reg_header(pr, buf);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA, "SERDES6G_COMMON_CFGA", &value);
        VENICE_DEBUG_SD6G_BIT(pr, SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA, ENA_LANE, value);
        VENICE_DEBUG_SD6G_BIT(pr, SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA, SYS_RST, value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGB, "SERDES6G_COMMON_CFGB", &value);

        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_SER_CFG, "SERDES6G_SER_CFG", &value);
        VENICE_DEBUG_SD6G_BIT(pr, SERDES6G_ANA_CFG_SERDES6G_SER_CFG, SER_ENALI, value);
        VENICE_DEBUG_SD6G_FLD(pr, SERDES6G_ANA_CFG_SERDES6G_SER_CFG, SER_ALISEL, value);

        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A, "SERDES6G_OB_CFG0A", &value);
        VENICE_DEBUG_SD6G_BIT(pr, SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A, OB_ENA1V_MODE, value);
        VENICE_DEBUG_SD6G_BIT(pr, SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A, OB_POL, value);
        VENICE_DEBUG_SD6G_FLD(pr, SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A, OB_POST0, value);
        VENICE_DEBUG_SD6G_FLD(pr, SERDES6G_ANA_CFG_SERDES6G_OB_CFG0A, OB_PREC, value);
        pr("\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_PLL_CFGA, "SERDES6G_PLL_CFGA", &value);
        
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS_XAUI_PCS_XAUI_STATUS_PCS_XAUI_STATUS, "XAUI_STATUS", &value);
        VENICE_DEBUG_XAUI_BIT(pr, PCS_XAUI_STATUS_PCS_XAUI_STATUS, ALIGNMENT_STATUS, value);
        VENICE_DEBUG_XAUI_FLD(pr, PCS_XAUI_STATUS_PCS_XAUI_STATUS, SYNC_STATUS, value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS_XAUI_PCS_XAUI_STATUS_PCS_XAUI_STATUS2, "XAUI_STATUS2", &value);
        VENICE_DEBUG_XAUI_BIT(pr, PCS_XAUI_STATUS_PCS_XAUI_STATUS2, LINK_STATE, value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_SD_CFG, "XAUI_SD_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS_XAUI_PCS_XAUI_CONFIGURATION_PCS_XAUI_CFG2, "XAUI_CFG2", &value);

        pr("\nSERDES6G_ANA_STATUS (lanes 0-3):\n");
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_PLL_STATUS(0), &lane0);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_PLL_STATUS(1), &lane1);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_PLL_STATUS(2), &lane2);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_PLL_STATUS(3), &lane3);
        VENICE_DEBUG_SD6GL_BIT(pr, SERDES6G_ANA_STATUS_SERDES6G_PLL_STATUS, PLL_OUT_OF_RANGE_ERR, lane0, lane1, lane2, lane3);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0(0), &lane0);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0(1), &lane1);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0(2), &lane2);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0(3), &lane3);
        VENICE_DEBUG_SD6GL_BIT(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0, IB_HP_GAIN_ACT,  lane0, lane1, lane2, lane3);
        VENICE_DEBUG_SD6GL_BIT(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0, IB_MID_GAIN_ACT, lane0, lane1, lane2, lane3);
        VENICE_DEBUG_SD6GL_BIT(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0, IB_LP_GAIN_ACT,  lane0, lane1, lane2, lane3);
        VENICE_DEBUG_SD6GL_BIT(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0, IB_OFFSET_ACT,   lane0, lane1, lane2, lane3);
        VENICE_DEBUG_SD6GL_BIT(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0, IB_OFFSET_VLD,   lane0, lane1, lane2, lane3);
        VENICE_DEBUG_SD6GL_BIT(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0, IB_OFFSET_ERR,   lane0, lane1, lane2, lane3);
        VENICE_DEBUG_SD6GL_BIT(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0, IB_OFFSDIR,      lane0, lane1, lane2, lane3);
        VENICE_DEBUG_SD6GL_BIT(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS0, IB_SIG_DET,      lane0, lane1, lane2, lane3);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1A(0), &lane0);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1A(1), &lane1);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1A(2), &lane2);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1A(3), &lane3);
        VENICE_DEBUG_SD6GL_FLD(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1A, IB_HP_GAIN_STAT, lane0, lane1, lane2, lane3);
        VENICE_DEBUG_SD6GL_FLD(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1A, IB_MID_GAIN_STAT,lane0, lane1, lane2, lane3);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1B(0), &lane0);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1B(1), &lane1);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1B(2), &lane2);
        CSR_RD(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1B(3), &lane3);
        VENICE_DEBUG_SD6GL_FLD(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1B, IB_LP_GAIN_STAT, lane0, lane1, lane2, lane3);
        VENICE_DEBUG_SD6GL_FLD(pr, SERDES6G_ANA_STATUS_SERDES6G_IB_STATUS1B, IB_OFFSET_STAT,  lane0, lane1, lane2, lane3);

        pr("SD10G65 DES\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0, " DES_CFG0", &value);
        pr("SD10G65 OB\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0, " OB_CFG0", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG1, " OB_CFG1", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2, " OB_CFG2", &value);
        pr("SD10G65 IB\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0, " IB_CFG0", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG10, " IB_CFG10", &value);
        pr("SD10G65 RX SYNTH\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG0, " RX_SYNTH_CFG0", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG1, " RX_SYNTH_CFG1", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG2, " RX_SYNTH_CFG2", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG3, " RX_SYNTH_CFG3", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CFG4, " RX_SYNTH_CFG4", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_RX_SYNTH_SD10G65_RX_SYNTH_CDRLF, " RX_SYNTH_CDRLF", &value);
        pr("SD10G65 TX SYNTH\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0, " TX_SYNTH_CFG0", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1, " TX_SYNTH_CFG1", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG3, " TX_SYNTH_CFG3", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_SSC_CFG1, " SSC_CFG1", &value);
        pr("SD10G65_SYNC_CTRL\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG, " SYNC_CTRL_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_STAT, " SYNC_CTRL_STAT", &value);
        pr("CLOCK_OUTPUT\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG, " CONTROL_RXCK_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_TXCK_CFG, " CONTROL_TXCK_CFG", &value);
        pr("VENICE_DEV1\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_DEV1_LOOPBACK_CONTROL_PMA_LOOPBACK_CONTROL, " PMA_LOOPBACK_CONTROL", &value);
        pr("LINE_PCS1G_CFG_STATUS\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_CFG, " PCS1G_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG2, " PCS1G_ANEG_CFG2", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG, " PCS1G_ANEG_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS, " PCS1G_ANEG_STATUS", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS2, " PCS1G_LP_ADV_ABILITY", &value);

        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_SD_CFG, " PCS1G_SD_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_LINK_STATUS, " PCS1G_LINK_STATUS", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_STICKY, " PCS1G_STICKY", &value);


        CSR_WR(port_no, VTSS_PCS1G_LINE_PCS1G_CFG_STATUS_PCS1G_STICKY, value); /* clear sticky bits */
        pr("HOST_PCS1G_CFG_STATUS\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG, " PCS1G_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG2, " PCS1G_ANEG_CFG2", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_ANEG_CFG, " PCS1G_ANEG_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS, " PCS1G_ANEG_STATUS", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS2, " PCS1G_LP_ADV_ABILITY", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_SD_CFG, " PCS1G_SD_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_LINK_STATUS, " PCS1G_LINK_STATUS", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_STICKY, " PCS1G_STICKY", &value);
        CSR_WR(port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_STICKY, value); /* clear sticky bits */
        pr("FC_BUFFER\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_FC_BUFFER_CONFIG_FC_MODE_CFG, " FC_MODE_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_FC_BUFFER_CONFIG_TX_CTRL_QUEUE_CFG, " TX_CTRL_QUEUE_CFG", &value);
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_FC_BUFFER_CONFIG_TX_DATA_QUEUE_CFG, " TX_DATA_QUEUE_CFG", &value);
        pr("VENICE_PCS\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_PCS_PCS_Control_1_PCS_Control_1, " PCS_Control_1", &value);
        pr("VENICE_WIS\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_WIS_WIS_Control_1_WIS_CTRL1, " WIS_CTRL1", &value);
        pr("FIFO_BIST\n");
        venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_FIFO_BIST_Datapath_Control_Datapath_Control, " Datapath_Control", &value);

        if (port_no == PHY_BASE_PORT(port_no)) {
            pr("F2DF\n");
            
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_DES_F2DF_DES_CFG0, " DES_CFG0", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_SBUS_RX_CFG, " SBUS_RX_CFG", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG0, " RX_RCPLL_CFG0", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG1, " RX_RCPLL_CFG1", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG2, " RX_RCPLL_CFG2", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0, " RX_SYNTH_CFG0", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1, " RX_SYNTH_CFG1", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2, " RX_SYNTH_CFG2", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG3, " RX_SYNTH_CFG3", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CDRLF, " RX_SYNTH_CDRLF", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0, " IB_CFG0", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG2, " IB_CFG2", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4, " IB_CFG4", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG5, " IB_CFG5", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG6, " IB_CFG6", &value);
            venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG8, " IB_CFG8", &value);
            if (venice_rev_a(vtss_state, port_no)) {
                /* enable F2DF */
                venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT, " CFG_STAT", &value);
            } else {
                venice_deb_pr_reg(vtss_state, pr, port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_REV_B, " CFG_STAT", &value);
            }
        }
        pr("\n");

    }

    return VTSS_RC_OK;
}


/* F2DF is the name of a 10G-receiver macro used for SREFCLK input */
static vtss_rc phy_10g_f2df_set(struct vtss_state_s *vtss_state,
                                   vtss_port_no_t port_no)
{
#define F2DF_MAX_MODES 3
    /*                                                          125MHz, 156,25MHz, 155,52MHz */
    static const u32 f2df_des_if_mode_sel        [F2DF_MAX_MODES] = {     3,         2,         2};
    static const u32 f2df_pllf_ref_cnt_end       [F2DF_MAX_MODES] = {   512,       409,       411};
    static const u32 f2df_synth_freq_mult        [F2DF_MAX_MODES] = {0x2002,    0x2002,    0x1fdb};
    static const u32 f2df_synth_freqm_1          [F2DF_MAX_MODES] = {     0,         0,         5};
    static const u32 f2df_synth_freqm_0          [F2DF_MAX_MODES] = {     0,         0,0xD0D8CB08};
    static const u32 f2df_side_det_bit_sel       [F2DF_MAX_MODES] = {     5,         4,         4};
    vtss_phy_10g_srefclk_mode_t *srefclk = &vtss_state->phy_10g_state[port_no].srefclk;
    
    u32 reg_idx = srefclk->freq == VTSS_PHY_10G_SREFCLK_125_00 ? 0 : 
                  srefclk->freq == VTSS_PHY_10G_SREFCLK_156_25 ? 1 :
                  srefclk->freq == VTSS_PHY_10G_SREFCLK_155_52 ? 2 : 1; /* 156,25 is default */
    VTSS_D("port %d, f2df reference mode %d", port_no, reg_idx);

    BOOL rev_a = venice_rev_a(vtss_state, port_no);
    if (port_no == PHY_BASE_PORT(port_no)) {
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_SBUS_RX_CFG,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_SBUS_RX_CFG_SBUS_BIAS_EN,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_SBUS_RX_CFG_SBUS_BIAS_EN);
        
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG2,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG2_PLL_ENA,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG2_PLL_ENA);

        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_ENA,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_ENA);

        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_SAM_ENA |
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_CLKDIV_ENA,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_SAM_ENA |
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_CLKDIV_ENA);

        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG8,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG8_IB_CML_CURR(0),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG8_IB_CML_CURR);

        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0,
                1,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_SPEED_SEL);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1_SYNTH_FREQ_MULT(8192),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1_SYNTH_FREQ_MULT);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_FBDIV_SEL(0),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_FBDIV_SEL);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_FB_STEP(3),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_FB_STEP);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_EQZ_ENA,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_EQZ_ENA);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_DFE_ENA,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_DFE_ENA);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_LD_ENA,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_LD_ENA);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_IA_SDET_ENA,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG0_IB_IA_SDET_ENA);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG5,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG5_IB_OFFS_VALUE(31),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG5_IB_OFFS_VALUE);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG8,
                0,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG8_IB_LAT_NEUTRAL);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_VSCOPE_H_THRES(40),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_VSCOPE_H_THRES);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_VSCOPE_L_THRES(23),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_VSCOPE_L_THRES);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_EQZ_C_ADJ_IB(0),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_EQZ_C_ADJ_IB);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_EQZ_C_ADJ_ES2(0),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_EQZ_C_ADJ_ES2);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_EQZ_C_ADJ_ES1(0),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_EQZ_C_ADJ_ES1);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_EQZ_C_ADJ_ES0(0),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG4_IB_EQZ_C_ADJ_ES0);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG2,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG2_IB_EQZ_GAIN(300),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG2_IB_EQZ_GAIN);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG6,
                VTSS_F_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG6_IB_EQZ_GAIN_ADJ(70),
                VTSS_M_VENICE_GLOBAL32_F2DF_IB_F2DF_IB_CFG6_IB_EQZ_GAIN_ADJ);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_SPARE_POOL(7),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_SPARE_POOL);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_PHASE_DATA(64),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_PHASE_DATA);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_PHASE_AUX(42),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_PHASE_AUX);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_P_STEP,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_P_STEP);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_I1_STEP,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_I1_STEP);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1E(3),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1E);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1M(3),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I1M);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CDRLF,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL(47),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CDRLF_SYNTH_INTEG2_FSEL);

        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_DES_F2DF_DES_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_DES_F2DF_DES_CFG0_DES_IF_MODE_SEL(f2df_des_if_mode_sel[reg_idx]),
                VTSS_M_VENICE_GLOBAL32_F2DF_DES_F2DF_DES_CFG0_DES_IF_MODE_SEL); 

        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG2,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG2_PLL_LPF_CUR(0),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG2_PLL_LPF_CUR);
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG1,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG1_PLLF_REF_CNT_END(f2df_pllf_ref_cnt_end[reg_idx]),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG1_PLLF_REF_CNT_END);
        VTSS_MSLEEP(20); // According to Matthias Koehne
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_HRATE_ENA,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        VTSS_MSLEEP(20); // According to Matthias Koehne
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0,
                0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG0_SYNTH_HRATE_ENA);
        VTSS_MSLEEP(20); // According to Matthias Koehne
        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG0_PLLF_ENA,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_RCPLL_F2DF_RX_RCPLL_CFG0_PLLF_ENA);

        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1_SYNTH_FREQ_MULT(f2df_synth_freq_mult[reg_idx]),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1_SYNTH_FREQ_MULT);

        CSR_WRM(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1_SYNTH_FREQM_1(f2df_synth_freqm_1[reg_idx]),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG1_SYNTH_FREQM_1);

        CSR_WR(port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG3, f2df_synth_freqm_0[reg_idx]);

        
        /* The address of VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT is incremented by one in Rev B. */        
        CSR_WRM(port_no,
                VEN_REV(rev_a, VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT),
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_SIDE_DET_BIT_SEL(f2df_side_det_bit_sel[reg_idx]),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_SIDE_DET_BIT_SEL);
        CSR_WRM(port_no, 
                VEN_REV(rev_a, VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT),
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_SIDE_DET_ONES_WEIGHT(2),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_SIDE_DET_ONES_WEIGHT);
        CSR_WRM(port_no, 
                VEN_REV(rev_a, VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT),
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_SIDE_DET_ZEROS_WEIGHT(2),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_SIDE_DET_ZEROS_WEIGHT);
        CSR_WRM(port_no, 
                VEN_REV(rev_a, VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT),
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_TOG_DET_CNT(63),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_TOG_DET_CNT);
        CSR_WRM(port_no, 
                VEN_REV(rev_a, VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT),
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_ENABLE,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_ENABLE);
        CSR_WRM(port_no, 
                VEN_REV(rev_a, VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT),
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_STICKY_CLR,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_STICKY_CLR);            
        CSR_WRM(port_no, 
                VEN_REV(rev_a, VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT),
                0,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_STICKY_CLR);
    }
    return VTSS_RC_OK;
}

static vtss_rc phy_10g_srefclk_set_internal(struct vtss_state_s *vtss_state,
                                            vtss_port_no_t port_no,
                                            vtss_phy_10g_srefclk_mode_t *srefclk)
{
    vtss_port_no_t base_port_no = PHY_BASE_PORT(port_no);
    BOOL rev_a = venice_rev_a(vtss_state, port_no);

    /* Port setup */
    if (srefclk->enable) {
        VTSS_D("Enable srefclk for iport %d", port_no);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT(
                rx_tx_synth_freq_mult_l3[phy_10g_rx_tx_reg_mode_idx(vtss_state, port_no)]),
                VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT);
        CSR_WR(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG3,
                rx_tx_synth_freqm_0_l3[phy_10g_rx_tx_reg_mode_idx(vtss_state, port_no)]);

        CSR_WRM(port_no, VTSS_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG,
                VTSS_F_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC(2),
                VTSS_M_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC);
        /* resynchronize the F2FD block */
        /* reset I2 */
        CSR_WRM(base_port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E(1),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E);

        /* The address of VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT is incremented by one in Rev B. */        
        /* enable F2DF */
        CSR_WRM(base_port_no, 
                VEN_REV(rev_a, VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT),
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_ENABLE,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_CFG_STAT_F2DF_ENABLE);
        
        /* enable I2 to use F2DF */
        CSR_WRM(base_port_no, VTSS_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2,
                VTSS_F_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E(0),
                VTSS_M_VENICE_GLOBAL32_F2DF_RX_SYNTH_F2DF_RX_SYNTH_CFG2_SYNTH_DV_CTRL_I2E);

    } else {
        VTSS_D("Disable srefclk for iport %d", port_no);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG,
                VTSS_F_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC(3),
                VTSS_M_VENICE_DEV1_SD10G65_SYNC_CTRL_SYNC_CTRL_CFG_LANE_SYNC_SRC);
        CSR_WR(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG3,
               rx_tx_synth_freqm_0_norm[phy_10g_rx_tx_reg_mode_idx(vtss_state, port_no)]);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT(
                rx_tx_synth_freq_mult_norm[phy_10g_rx_tx_reg_mode_idx(vtss_state, port_no)]),
                VTSS_M_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG1_SYNTH_FREQ_MULT);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_TX_SYNTH_SD10G65_TX_SYNTH_CFG0_SYNTH_LS_ENA);
    }
    return VTSS_RC_OK;
}

static vtss_rc phy_10g_srefclk_set(struct vtss_state_s *vtss_state,
                                   vtss_port_no_t port_no)
{
    vtss_phy_10g_loopback_t *loopback = &vtss_state->phy_10g_state[port_no].loopback;
    // if L3 loopback is enabled, then we cannot lock to srefclk (when L3 is disabled, the sfreclk configuration is applied)
    if (loopback->enable && loopback->lb_type == VTSS_LB_L3) {
        VTSS_D("cannot lock to srefclk while L3 loopback is enabled");
        return VTSS_RC_OK;
    } else {
        VTSS_D("Set srefclk port_no %d, srefclk %d", port_no, vtss_state->phy_10g_state[port_no].srefclk.enable);
        return  phy_10g_srefclk_set_internal(vtss_state, port_no, &vtss_state->phy_10g_state[port_no].srefclk);
    }
}

static vtss_rc phy_10g_rxckout_set(struct vtss_state_s *vtss_state,
                                   vtss_port_no_t port_no)
{
    vtss_phy_10g_rxckout_conf_t  rxckout = vtss_state->phy_10g_state[port_no].rxckout;
    u32 rxckout_sel;
    if (vtss_state->phy_10g_state[port_no].mode.oper_mode == VTSS_PHY_1G_MODE) {
        rxckout_sel = rxckout.mode == VTSS_RECVRD_CLKOUT_LINE_SIDE_TX_CLOCK ? 2 : 0;
    } else {
        rxckout_sel = rxckout.mode == VTSS_RECVRD_CLKOUT_LINE_SIDE_TX_CLOCK ? 3 : 1;
    }
    /* Disable/enable */
    VTSS_D("Set rxckout port_no %d, mode %d, squelch: pcs_fault %d, lopc %d", port_no, rxckout.mode, rxckout.squelch_on_pcs_fault, rxckout.squelch_on_lopc);
    CSR_WRM(port_no, VTSS_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG,
            (rxckout.squelch_on_pcs_fault ? VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG_RXCK_PCS_FAULT_MASK : 0) |
            (rxckout.squelch_on_lopc ? VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG_RXCK_LOPC_MASK : 0) |
            (rxckout.mode != VTSS_RECVRD_CLKOUT_DISABLE ? VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG_RXCKOUT_ENABLE : 0) |
            VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG_RXCKOUT_SEL(rxckout_sel),
            VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG_RXCK_PCS_FAULT_MASK |
            VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG_RXCK_LOPC_MASK |
            VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG_RXCKOUT_ENABLE |
            VTSS_M_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_RXCK_CFG_RXCKOUT_SEL);
    return VTSS_RC_OK;
}

static vtss_rc phy_10g_txckout_set(struct vtss_state_s *vtss_state,
                                   vtss_port_no_t port_no)
{
    vtss_phy_10g_txckout_conf_t txckout = vtss_state->phy_10g_state[port_no].txckout;
    u32 txckout_sel;
    if (vtss_state->phy_10g_state[port_no].mode.oper_mode == VTSS_PHY_1G_MODE) {
        txckout_sel = txckout.mode == VTSS_RECVRD_CLKOUT_LINE_SIDE_RX_CLOCK ? 2 : 0;
    } else {
        txckout_sel = txckout.mode == VTSS_RECVRD_CLKOUT_LINE_SIDE_RX_CLOCK ? 3 : 1;
    }
    /* Disable/enable */
    VTSS_D("Set txckout port_no %d, mode %d", port_no, txckout.mode);
    CSR_WRM(port_no, VTSS_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_TXCK_CFG,
            (txckout.mode != VTSS_RECVRD_CLKOUT_DISABLE ? VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_TXCK_CFG_TXCKOUT_ENABLE : 0) |
            VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_TXCK_CFG_TXCKOUT_SEL(txckout_sel),
            VTSS_F_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_TXCK_CFG_TXCKOUT_ENABLE |
            VTSS_M_VENICE_DEV1_CLOCK_OUTPUT_CONTROL_TXCK_CFG_TXCKOUT_SEL);
    return VTSS_RC_OK;
}

/* Enable / Disable the power for all sublayers */
static vtss_rc phy_10g_power_set(vtss_state_t *vtss_state,
                                 const vtss_port_no_t port_no)

{
    BOOL state;
    VTSS_D("Enter");
    state = (vtss_state->phy_10g_state[port_no].power == VTSS_PHY_10G_POWER_DISABLE) ? TRUE : FALSE;
    
    if(state) {
        VTSS_D("Venice power down");
        /* 1xF200.0 = 1 is to disable the SFI deserializer */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0,
               VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0_DES_DIS,
               VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0_DES_DIS);
        /* 1xF220.13 = 0 is to disable the SFI output buffer and serializer */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_OB);
        /* 1xF240.3 = 0 is to disable Vscope path of sampling-stage */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_VSCOPE_ENA);
        /* 1xF240.2 = 0 is to disable sampling stage */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_SAM_ENA);
        /* 1xF240.1 = 0 is to disable equalization stage */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_EQZ_ENA);
        /* 4xE629.2 = 0 is to disable the XAUI lane */
        CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA,
                0,
                VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_ENA_LANE);
        /* 4xE629.1 = 1 is to power down XAUI Rx path */
        CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA,
                VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_PWD_RX,
                VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_PWD_RX);
        /* 4xE629.0 = 1 is to power down XAUI Tx path */
        CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA,
                VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_PWD_TX,
                VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_PWD_TX);
    } else {
        VTSS_D("Venice power up");
        /* When disabling the low power function */
        /* 1xF200.0 = 0 is to enable the SFI deserializer  */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_DES_SD10G65_DES_CFG0_DES_DIS);
        /* 1xF220.13 = 1 is to enable the SFI output buffer and serializer */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_OB,
                VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_OB);
        /* 1xF240.3 = 0 is to disable Vscope path of sampling-stage (this bit should stay at 0 until the feature is enabled) */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_VSCOPE_ENA);
        /* 1xF240.2 = 1 is to enable sampling stage */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_SAM_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_SAM_ENA);
        /* 1xF240.1 = 1 is to enable equalization stage */
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_EQZ_ENA,
                VTSS_F_VENICE_DEV1_32_SD10G65_IB_SD10G65_IB_CFG0_IB_EQZ_ENA);
        /* 4xE629.2 = 1 is to enable the XAUI lane */
        CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA,
                VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_ENA_LANE,
                VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_ENA_LANE);
        /* 4xE629.1 = 0 is to power up XAUI Rx path */
        CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA,
                0,
                VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_PWD_RX);
        /* 4xE629.0 = 0 is to power up XAUI Tx path */
        CSR_WRM(port_no, VTSS_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA,
                0,
                VTSS_F_VENICE_DEV4_SERDES6G_ANA_CFG_SERDES6G_COMMON_CFGA_PWD_TX);
    }
    
    VTSS_D("Exit");
    return VTSS_RC_OK;
}

#ifdef VTSS_FEATURE_10GBASE_KR
static const int predrv_ctrl_table[VTSS_SLEWRATE_INVALID][2] = {{3,3}, {3,0},{0,3}, {1,0},{0,0}};
/* Get 10GBASE_KR coefficients from HW */
static vtss_rc phy_10g_kr_conf_init(vtss_state_t *vtss_state,
                            const vtss_port_no_t port_no)
{
    u32 cfg0, cfg1, cfg2, r_ctrl, c_ctrl;
    i32 v[4];
    int i;
    vtss_rc rc = VTSS_RC_OK;
    vtss_phy_10g_base_kr_conf_t *kr_conf = &vtss_state->phy_10g_state[port_no].kr_conf;
    CSR_RD(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0, &cfg0);
    CSR_RD(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG1, &cfg1);
    CSR_RD(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2, &cfg2);
    for (i = 0; i < 4; i++) {
        v[i] = cfg2>>(6*i) & 0x3f;
        if (v[i] & 0x20) v[i] |= ~0x3f; /* sign extension */
    }
    kr_conf->cm1 = (-v[3]- v[0] - 1)/2;
    kr_conf->c0 = (v[3] - v[1] -1)/2;
    kr_conf->c1 = (v[1] - v[0])/2;
    kr_conf->ampl = 1275 - 25*VTSS_X_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_LEVN(cfg0) -
                    200*((cfg0 & VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_INCR_LEVN) ? 1 : 0);
    
    r_ctrl = VTSS_X_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG1_PREDRV_R_CTRL(cfg1);
    c_ctrl = VTSS_X_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG1_PREDRV_C_CTRL(cfg1);
    kr_conf->slewrate = VTSS_SLEWRATE_INVALID;
    for (i = 0; i < VTSS_SLEWRATE_INVALID; i++) {
        if ((r_ctrl == predrv_ctrl_table[i] [1]) && (c_ctrl == predrv_ctrl_table[i] [0])) {
            kr_conf->slewrate = i;
        }
    }
    kr_conf->en_ob = ( cfg0 & VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_OB) ? TRUE : FALSE;
    kr_conf->ser_inv = ( cfg0 & VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_SER_INV) ? TRUE : FALSE;;
    return rc;
}


/* Set 10GBASE_KR coefficients */
static vtss_rc phy_10g_base_kr_conf_set(vtss_state_t *vtss_state,
                                              const vtss_port_no_t port_no)

{
    i32 v[4];
    u32 v_sum, levn, incr_levn, value, mask;
    int i;
    vtss_rc rc = VTSS_RC_OK;
    /* map slewrate to PREDRV_C_CTRL (index 0), PREDRV_R_CTRL (index 1) */
    VTSS_D("Enter");
    vtss_phy_10g_base_kr_conf_t kr_conf = vtss_state->phy_10g_state[port_no].kr_conf;
    v[0] = -kr_conf.cm1 -kr_conf.c0 -kr_conf.c1-1;
    v[1] = -kr_conf.cm1 -kr_conf.c0 +kr_conf.c1-1;
    v[2] = -kr_conf.cm1 +kr_conf.c0 -kr_conf.c1;
    v[3] = -kr_conf.cm1 +kr_conf.c0 +kr_conf.c1;
    /* values are 6 bit signed i.e. -32..31, therefore values >31 or <-32 are trunkated */
    for (i = 0; i < 4; i++) {
        if (v[i] > 31) {v[i] = 31; rc = VTSS_RC_ERR_KR_CONF_INVALID_PARAMETER;}
        if (v[i] < -32) {v[i] = -32; rc = VTSS_RC_ERR_KR_CONF_INVALID_PARAMETER;}
    }
    if ((VTSS_LABS(kr_conf.c0) + VTSS_LABS(kr_conf.c1) + VTSS_LABS(kr_conf.cm1)) > 31) {
        rc = VTSS_RC_ERR_KR_CONF_INVALID_PARAMETER;
    }
    if (kr_conf.ampl > 1275) {
        rc = VTSS_RC_ERR_KR_CONF_INVALID_PARAMETER;
    }
    if (kr_conf.slewrate >= VTSS_SLEWRATE_INVALID) {
        rc = VTSS_RC_ERR_KR_CONF_INVALID_PARAMETER;
    }
    if (rc == VTSS_RC_OK) {
        v_sum = VTSS_ENCODE_BITFIELD(v[0],0,6) | VTSS_ENCODE_BITFIELD(v[1],6,6) | 
               VTSS_ENCODE_BITFIELD(v[2],12,6) | VTSS_ENCODE_BITFIELD(v[3],18,6);
        VTSS_D("v[0] %d, v[1] %d, v[2] %d, v[3] %d, v_sum 0x%x", v[0], v[1], v[2], v[3], v_sum);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2,
                VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2_D_FILTER(v_sum),
                VTSS_M_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG2_D_FILTER);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG1,
                VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG1_PREDRV_R_CTRL(predrv_ctrl_table[kr_conf.slewrate][1]) |
                VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG1_PREDRV_C_CTRL(predrv_ctrl_table[kr_conf.slewrate][0]),
                VTSS_M_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG1_PREDRV_R_CTRL |
                    VTSS_M_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG1_PREDRV_C_CTRL);
        if (kr_conf.ampl > 1075) {
            incr_levn = 0;
            levn = (1275 - kr_conf.ampl)/25;
        } else {
            incr_levn = 1;
            levn = (1075 - kr_conf.ampl)/25;
        }
        VTSS_D("ampl %d, incr_levn %d, levn %d", kr_conf.ampl, incr_levn, levn);
        value = (kr_conf.ser_inv ? VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_SER_INV : 0) |
                (kr_conf.en_ob ? VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_OB : 0) |
                (incr_levn ? VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_INCR_LEVN : 0) |
                VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_LEVN(levn);
        mask = VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_SER_INV |
               VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_EN_OB |
               VTSS_F_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_INCR_LEVN |
               VTSS_M_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0_LEVN;
        VTSS_D("value 0x%x, mask 0x%x", value, mask);
        CSR_WRM(port_no, VTSS_VENICE_DEV1_32_SD10G65_OB_SD10G65_OB_CFG0,
                value, mask);
    }
    return rc;
}
#endif /* VTSS_FEATURE_10GBASE_KR */

static vtss_rc phy_10g_clause_37_adv_get(u32 value, vtss_phy_10g_clause_37_adv_t *adv)
{
//    adv->fdx = VTSS_BOOL(value & (1<<5));
    adv->fdx = 1; // FDX is always 1
    adv->hdx = VTSS_BOOL(value & (1<<6));
    adv->symmetric_pause = VTSS_BOOL(value & (1<<7));
    adv->asymmetric_pause = VTSS_BOOL(value & (1<<8));
    switch ((value>>12) & 3) {
    case 0:
        adv->remote_fault = VTSS_PHY_10G_CLAUSE_37_RF_LINK_OK;
        break;
    case 1:
        adv->remote_fault = VTSS_PHY_10G_CLAUSE_37_RF_LINK_FAILURE;
        break;
    case 2:
        adv->remote_fault = VTSS_PHY_10G_CLAUSE_37_RF_OFFLINE;
        break;
    default:
        adv->remote_fault = VTSS_PHY_10G_CLAUSE_37_RF_AUTONEG_ERROR;
        break;
    } 
    adv->acknowledge = VTSS_BOOL(value & (1<<14));
    adv->next_page = VTSS_BOOL(value & (1<<15));
    
    return VTSS_RC_OK;
}

/* Encode advertisement word */
static vtss_rc phy_10g_clause_37_adv_set(u32 *value, vtss_phy_10g_clause_37_adv_t *adv, BOOL aneg_enable)
{
    u32 rf;

    if (!aneg_enable) {
        *value = 0;
        return VTSS_RC_OK;
    }
    switch (adv->remote_fault) {
    case VTSS_PHY_10G_CLAUSE_37_RF_LINK_OK:
        rf = 0;
        break;
    case VTSS_PHY_10G_CLAUSE_37_RF_LINK_FAILURE:
        rf = 1;
        break;
    case VTSS_PHY_10G_CLAUSE_37_RF_OFFLINE:
        rf = 2;
        break;
    default:
        rf = 3;
        break;
    }

    *value = (((adv->next_page ? 1 : 0)<<15) |
              ((adv->acknowledge ? 1 : 0)<<14) |
              (rf<<12) |
              ((adv->asymmetric_pause ? 1 : 0)<<8) |
              ((adv->symmetric_pause ? 1 : 0)<<7) |
              ((adv->hdx ? 1 : 0)<<6) |
              ((adv->fdx ? 1 : 0)<<5));
    return VTSS_RC_OK;
}

static vtss_rc phy_10g_clause_37_control_set(vtss_state_t *vtss_state,
                                             const vtss_port_no_t port_no)
{
    vtss_phy_10g_clause_37_control_t *control = &vtss_state->phy_10g_state[port_no].clause_37;
    u32 value = 0, l_h;
    
    /* Set PCS control for both line and host */
    for (l_h = 0; l_h < 2; l_h++) {
        /* Aneg capabilities for this port */
        VTSS_RC(phy_10g_clause_37_adv_set(&value, &control->advertisement, control->enable));
        CSR_WRM(port_no, PST(VTSS_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG2),
                PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG2_ADV_ABILITY(value)),
                PST(VTSS_M_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG2_ADV_ABILITY));

        /* Restart aneg */
        CSR_WRM(port_no, PST(VTSS_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG),
                PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_ANEG_RESTART_ONE_SHOT) |
                PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_ANEG_ENA),
                PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_ANEG_RESTART_ONE_SHOT) |
                PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_ANEG_ENA));
       
        if (!control->enable) {
            /* Disable Aneg */
            CSR_WRM(port_no, PST(VTSS_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG),
                    PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_ANEG_RESTART_ONE_SHOT) |
                    0,
                    PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_ANEG_RESTART_ONE_SHOT) |
                    PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_CFG_ANEG_ENA));
        }
    }
    return VTSS_RC_OK;
}


/* Get 1000Base-X Fiber Auto-negotiation status (Clause 37) */
static vtss_rc phy_10g_clause_37_status_get(vtss_state_t *vtss_state,
                                            const vtss_port_no_t         port_no,
                                            vtss_phy_10g_clause_37_cmn_status_t *const status)
{
    BOOL link_down;
    u32 value, l_h;
    vtss_phy_10g_clause_37_status_t *stat;

    /* Get PCS status for both line and host */
    for (l_h = 0; l_h < 2; l_h++) {
        /* Get the link state 'down' sticky bit  */
        stat = l_h ? &status->host : &status->line;

        CSR_RD(port_no, PST(VTSS_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_STICKY), &value);

        link_down  = VTSS_BOOL(PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_STICKY_LINK_DOWN_STICKY) & value) ||
            VTSS_BOOL(PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_STICKY_OUT_OF_SYNC_STICKY) & value);

        if (link_down) {
            /* The link has been down. Clear the sticky bits and return the 'down' value  */
            CSR_WR(port_no, PST(VTSS_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_STICKY), value); /* clear sticky bits */
            stat->link = 0;
        } else {
            /*  Return the current status     */
            CSR_RD(port_no, PST(VTSS_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_LINK_STATUS), &value);
            stat->link = VTSS_BOOL(VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_LINK_STATUS_LINK_STATUS & value) &&
                VTSS_BOOL(PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_LINK_STATUS_SYNC_STATUS) & value);
        }        
        /* Get PCS ANEG status register */
        CSR_RD(port_no, PST(VTSS_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS), &value);
        
        /* Get 'Aneg complete'   */
        stat->autoneg.complete = VTSS_BOOL(value & PST(VTSS_F_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS_ANEG_COMPLETE));
      
        /* Return partner advertisement ability */
        CSR_RD(port_no, PST(VTSS_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS2), &value);
        value = PST(VTSS_X_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS2_LP_ADV_ABILITY(value));

        VTSS_RC(phy_10g_clause_37_adv_get(value, &stat->autoneg.partner_advertisement));

        /* /\* Workaround for a Serdes issue, when aneg completes with FDX capability=0 *\/ */
        /* if (stat->autoneg.complete) { */
        /*     if (stat->autoneg.partner_advertisement.fdx == 0) { */
        /*         printf("p:%d Workaround for FDX\n",port_no); */
        /*         CSR_WRM(port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG, */
        /*                 0, */
        /*                 VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG_PCS_ENA); */
        /*         CSR_WRM(port_no, VTSS_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG, */
        /*                 VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG_PCS_ENA, */
        /*                 VTSS_F_PCS1G_HOST_PCS1G_CFG_STATUS_PCS1G_CFG_PCS_ENA); */
                
        /*         (void)phy_10g_clause_37_control_set(vtss_state, port_no); /\* Restart Aneg *\/ */
        /*         VTSS_MSLEEP(50); */

        /*         CSR_RD(port_no, PST(VTSS_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS2), &value); */
        /*         value = PST(VTSS_X_PCS1G, l_h, PCS1G_CFG_STATUS_PCS1G_ANEG_STATUS2_LP_ADV_ABILITY(value)); */
        /*         VTSS_RC(phy_10g_clause_37_adv_get(value, &stat->autoneg.partner_advertisement)); */
        /*     } */
        /* } */

        VTSS_D("%s P:%d link:%d aneg complete:%d partner aneg ability:%x\n",
               l_h ? "Host":"Line", port_no, stat->link, stat->autoneg.complete, value);
    }
    return VTSS_RC_OK;
}

/**
 * \brief Create instance (set up function pointers), this function
 * should be called while creating the instance.
 *
 * \return Return code.
 **/

vtss_rc vtss_phy_10g_inst_venice_create(vtss_state_t *vtss_state)
{
    vtss_cil_func_t *func = &vtss_state->cil;

    func->phy_10g_mode_conf_set         = phy_10g_mode_conf_set;
    func->phy_10g_csr_read              = phy_10g_csr_read;
    func->phy_10g_csr_write             = phy_10g_csr_write;
    func->phy_10g_loopback_set          = phy_10g_loopback_set;
    func->phy_10g_rxckout_set           = phy_10g_rxckout_set;
    func->phy_10g_txckout_set           = phy_10g_txckout_set;
    func->phy_10g_srefclk_set           = phy_10g_srefclk_set;
    func->phy_10g_power_set             = phy_10g_power_set;
    func->phy_10g_clause_37_status_get  = phy_10g_clause_37_status_get;
    func->phy_10g_clause_37_control_set = phy_10g_clause_37_control_set;
#ifdef VTSS_FEATURE_10GBASE_KR
    func->phy_10g_base_kr_conf_set      = phy_10g_base_kr_conf_set;
#endif /* VTSS_FEATURE_10GBASE_KR */

    
    return VTSS_RC_OK;
}

#endif /* VTSS_CHIP_10G_PHY */

